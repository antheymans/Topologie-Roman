\documentclass[a4paper, 12pt]{report}




% Some highly suggested packages, please read their manuals.


%\usepackage{cmap}
\usepackage{longtable}
\setcounter{secnumdepth}{3} % default value for 'report' class is "2"
\usepackage{natbib}
\bibliographystyle{apalike}
\usepackage{url}
\usepackage{lscape}
\usepackage[utf8]{inputenc}
\usepackage{color}
\usepackage[pdftex]{graphicx}
%\usepackage[T1]{fontenc}
\usepackage[hmargin={1in,1in},vmargin={1in,1in}]{geometry}
\usepackage{pdfpages} 
\usepackage{tikz}
\usepackage{breqn}
\usepackage{subcaption}
\usepackage{csvsimple}
\usepackage{hyperref}
\usepackage{cleveref}
\usepackage[toc,page]{appendix} 
\usepackage{caption}


% Logos
\newcommand{\ulb}{\includegraphics[scale=1.1]{logo_ULB2.pdf}}
\newcommand{\polytech}{\includegraphics[scale=0.35]{logo_polytech_FR.pdf}}

% Polices
\definecolor{ULBblue}{rgb}{0,0.2196,0.5765}
\newcommand{\fontTitle}{\sffamily \Huge\selectfont \color{ULBblue}}
\newcommand{\fontSubtitle}{\sffamily \LARGE \selectfont \color{ULBblue}}
\newcommand{\fontText}{\sffamily \selectfont}
\newcommand{\fontColor}{\sffamily \selectfont \color{ULBblue}}

% Titre
\newcommand{\titleA}{\fontTitle{Etude de la topologie de réseaux d'acteurs}} % Titre identique au titre remis au secrétariat
\newcommand{\titleB}{\fontTitle{extraits à partir de romans célèbre}} % (dans la langue de rédaction a priori)
% Sous-titre
%\newcommand{\subtitle}{\fontSubtitle{Ligne du sous-titre du mémoire}} l73 uncomment
% Titre du diplôme
\newcommand{\diplomaA}{\fontText{Mémoire présenté en vue de l’obtention du diplôme}} % A laisser en Français
\newcommand{\diplomaB}{\fontText{d’Ingénieur Civil en informatique à finalité spécialisée}}

% Etudiant
\newcommand{\student}{\textbf{\sffamily \large Antoine Heymans}}

% Supervision
\newcommand{\promAa}{\fontColor{Promoteur}}
\newcommand{\promAb}{\fontText{Professeur Hugues Bersini}}
\newcommand{\deptA}{\fontColor{Service}}
\newcommand{\deptB}{\fontText{Iridia}}

% Année académique
\newcommand{\yearA}{\fontColor{Année académique}}
\newcommand{\yearB}{\fontText{2020 - 2021}}

\begin{document}
	\maxdeadcycles=200
	\thispagestyle{empty}
	\newgeometry{top=2.5cm, bottom=1.5cm, left=2.5cm, right=1cm}
	\setlength{\unitlength}{1mm}
	\extrafloats{100}
	\noindent\begin{picture}(175,257)
	
		\put(0,245){\polytech}
		\put(153,139.5){\ulb}
		
		\put(8,155){\makebox(150,10)[l]{\titleA}}
		\put(8,145){\makebox(150,10)[l]{\titleB}}
		%\put(8,135){\makebox(150,10)[l]{\subtitle}}
		
		\put(0,75){
		\begin{tikzpicture}[scale=0.1]
		\fill [fill=ULBblue](0,0) rectangle (0.8,90);
		\fill [fill=ULBblue](0,57) rectangle (152,57.8);
		\end{tikzpicture}}
		
		\put(8,120){\makebox(150,5)[l]{\diplomaA}}
		\put(8,115){\makebox(150,5)[l]{\diplomaB}}
		
		\put(8,75){\makebox(150,10)[l]{\selectfont \student}}
		
		\put(8,44){\makebox(80,5)[l]{\promAa}}
		\put(8,39){\makebox(80,5)[l]{\promAb}}
		%\put(8,31){\makebox(80,5)[l]{\promBa}} Commenter la ligne si pas nécessaire
		%\put(8,26){\makebox(80,5)[l]{\promBb}} % Commenter la ligne si pas nécessaire
		%\put(8,18){\makebox(80,5)[l]{\promCa}} % Commenter la ligne si pas nécessaire
		%\put(8,13){\makebox(80,5)[l]{\promCb}} % Commenter la ligne si pas nécessaire
		\put(8,5){\makebox(80,5)[l]{\deptA}}
		\put(8,0){\makebox(80,5)[l]{\deptB}}
		
		\put(145,5){\makebox(30,5)[r]{\yearA}}
		\put(145,0){\makebox(30,5)[r]{\yearB}}
	
	\end{picture}
	\restoregeometry
% > > > Empty page
\thispagestyle{empty} 
\null
 \includepdf[pages={1}]{memoire-autorisation}

\begin{abstract}
Social network analysis is a field that uses computer science in order to produce results in many fields as sociology or psychology. Some research in social networks concerns the networks of characters described in fiction such as novels or films.
In this work, a software extracting social networks from literature has been deepened and the resulting social networks have been analyzed.\\

The development of the software consists of its extension to movie scripts and the creation of new algorithms for character extraction.
The initial program was using proper nouns (single word names) rather than proper names (single or multiple word names).
An algorithm created for novels extracts proper names and iteratively links them in a multi-pass way, based on semantic information and inferred genders. The rate of extracted characters wrongly considered as such is divided by 2 and some of them are labeled with a gender. A second algorithm has been created to extract characters in scripts. It's using annotated speaker from scripts and a basic alias resolution system to solve variation in the names provided by the annotations. The algorithm designed for novels is providing bad results for scripts as they contain less narration. The one designed for scripts gives results that seem more accurate as the one given on novels by the related algorithm. \\

The analysis of the extracted networks consists in the computing of some metrics to characterize them as scale-free or small world and an analysis of the gender distributions. It shows that all social networks have the small-world property and the ones extracted from novels can be considered scale-free. 
This is not the case with scripts even if they seem to approach some scale-free properties. Male characters are most frequent in both novels and scripts and they tend to have bigger degrees. In both cases, the gap is more important in movie scripts.
\end{abstract}


\newpage
\section*{Résumé}
Ce mémoire de fin d'étude a été réalisé par Antoine Heymans
en vue de l'obtention d'un master d’ingénieur civil en informatique à finalité spécialisée à l’Université Libre de Bruxelles en 2020-2021.
Le titre complet du mémoire est ``Étude de la topologie de réseaux d'acteurs extraits à partir de roman célèbre.''.\\

Ce travail prend place dans le cadre de l'analyse de réseaux sociaux,
un champ de recherches qui mêle science informatique et d'autres domaines tels que la sociologie ou la psychologie.
Le mémoire est séparé en deux parties: premièrement le développement d'un logiciel existant permettant d'extraire des réseaux sociaux à partir de textes de fiction.
La deuxième partie du mémoire consiste en l'analyse des réseaux précédemment obtenus.\\


Deux changements majeurs ont été apportés au logiciel: tout d'abord le fonctionnement du logiciel a été adapté pour permettre l'utilisation de scripts de films,
le programme initial n'ayant été conçu que pour les romans.
Ensuite, alors qu'initialement l'unité lexicale désignant les personnages était le nom propre composé d'un seul mot,
le logiciel a été modifié pour permettre au programme d'extraire des noms de personnages composés de plusieurs mots.
Cette modification permet d'accéder à davantage d'information lors du processus de résolution d'alias tout en le rendant plus complexe.
Une difficulté majeure réside dans le fait que le programme repose sur une librairie de traitement automatique du langage naturel
qui ne permets pas l'utilisation de certains outils. Deux algorithmes ont été créés afin d'extraire les personnages dans le cas des romans et des scripts.
Dans le cas des romans, il s'agit d'un algorithme à passes multiples catégorisant l'ensemble des alias
puis les liant entre eux itérativement en se basant essentiellement sur l'information sémantique qu'ils contiennent.
Dans le cas des scripts, des alias sont récupérés à partir des annotations puis certains d'entre eux sont liés.
Les deux algorithmes affectent également un genre aux différents alias.
Les résultats montrent que la précision de l'extraction de personnages dans les romans est similaire à une autre méthode de l'état de l'art.
Cette précision est approximativement le double de la précision obtenue avec le logiciel original.
Le second algorithme permet d'obtenir avec les scripts un résultat légèrement plus précis.
Enfin les réseaux obtenus comprennent le genre d'une partie des personnages.\\

La caractérisation des réseaux obtenus a été réalisée en mesurant différentes métriques afin de déterminer si ces réseaux peuvent être considérés étant des réseaux ``petit monde''
ou invariants d'échelles. La distribution des genres parmi les personnages a été également analysée.
Les résultats montrent que les réseaux extraits à partir de romans répondent à ces deux définitions.
Les réseaux extraits de scripts de films en revanche possèdent la propriété du ``petit monde''
mais pas toutes les propriétés requises que pour être considérés comme invariants d'échelle.
Les personnages masculins sont plus fréquents dans les romans comme dans les scripts mais cet écart est plus grand dans le cas des scripts.
Ceux-ci tendent également à avoir des personnages féminins connectés à moins d'interlocuteurs.


%\newpage

%\section*{Popularizing article}
%Social network analysis is an interdisciplinary field originally developed under the influence of sociology and mathematics \citep{history_social}.
%It consists of using graphs and networks theory to represent relations among actors as a network to analyze them.
%Originally the ``actor'' used in the network are people but some fields use it to represent abstract entities such as organizations related between them by financial exchange \citep{general_sna}.
%This makes Social Network Analysis useful in various fields like geography \citep{economic_geography} or organizations management \citep{management}.
%It has been used in psychology \citep{psy} as it ''provides a powerful set of tools for describing and modeling the relational context in which behavior takes place, as well as the relational dimensions of that behavior''\citep{intro}.
%It has also concrete applications outside the academic world: \cite{criminal} provides several interviews with operational agents of Criminal Intelligence Analysis using Social Network Analysis and suggests more collaboration between researcher and practitioners.
%Social network analysis has also be designated as a way to enforce laws and disrupt gangs by The International Association of Chiefs of Police \citep{police}. \\
%
%Research in computer science is developing semantically-oriented techniques to analyze fiction. \cite{character_country} presented a method to extract social networks from literature
% which allows the application of Social Network Analysis techniques on it. \cite{movie} presented a method to extract a social network from movies. Automated methods that analyze texts of fiction also produce metadata that help to analyze them.
%For instance, \cite{original} produce the social networks based on novels but also count the mean distance between two dialogs in the novel.
%This measure produces meaningful results when it is used to classify novels. Social networks can be seen as metadata with the particularity of being present in any fiction no matter the support of this fiction.
%Other metadata are only measurable in movies, novels...
%Those analyses may be used in the future to group fictions that share common properties for commercial purposes. It may also be used to produce sociological observation on literature: for instance, \cite{character_country} observe the evolution of social networks extracted from novels during the 19th century and the difference between plots taking place in urban or rural areas.\\
%
%This master thesis consists firstly in the development of a software that extracts social networks and other metadata from novels and movie scripts. Secondly, it consists of the analysis of the topology of the extracted networks. The software has been originally developed during another master thesis \citep{original_thesis} and further advancement have been achieved in \cite{original}. It was initially only working with novels.\\
%
%The development of the software consists of extending its application to movie scripts and creating new algorithms for character extraction. Character extraction is a major part of social network extraction. It consists of extracting all names related to characters in the text, binding names that refer to the same character, and separating names related to different characters. This task is non-trivial as characters are not always mentioned using their first name and last name. The main improvement of this work was to use multiple word names instead of single word names to designate characters. This gives more information to the program to work with but also increases the task difficulty. After these changes, the rate of extracted characters wrongly considered as such is divided by 2 and some of them are labeled with a gender. The gender labels are later used to analyze deeper the social network extracted.\\
%
%Social networks can be classified into different ``families'' of networks sharing different topological properties or emergence mechanisms. During the second part of this work, measures have been taken to characterize the extracted social networks into those families. They have also been compared with networks generated with the same size and belonging to those families. This showed some differences between networks extracted from movies and novels. The repartition of male and female characters has also been observed. Male characters are most frequent in both novels and scripts and they tend to share relations with more characters. In both cases, the gap is more important in movie scripts.






\section*{Acknowledgement}
I would like to thank my promoter Hugues Bersini for giving me the opportunity to work on this interesting project and to guide me along with this thesis. I would like to thank Michael Waumans and Thibault Nicodème who started this project and provide me a software that I could use as the basis of this master thesis. I would also like to thanks Mathias Dewilde that share with me his linguistic knowledge and Marion Guillaume, Joachim Balis, Gabrielle Froes and Solène Rimbault for their support.
\tableofcontents

\chapter{Introduction}
Social network analysis is an interdisciplinary field originally developed under the influence of sociology and mathematics \citep{history_social}. It consists of using graphs and networks theory to represent relations among actors as a network in order to analyze them. Originally the ``actors'' used in the network are people, but some fields use it to represent abstract entities such as organizations related by financial exchange \citep{general_sna}. This makes Social Network Analysis useful in various fields like geography \citep{economic_geography} or organizations management \citep{management}. It has been used in psychology \citep{psy} as it ''provides a powerful set of tools for describing and modeling the relational context in which behavior takes place, as well as the relational dimensions of that behavior''\citep{intro}. It also has concrete applications outside the academic world: \cite{criminal} provides several interviews with operational agents of Criminal Intelligence Analysis using Social Network Analysis and suggest more collaboration between researchers and practitioners. Social network analysis has also been designated as a way to enforce laws and disrupt gangs by The International Association of Chiefs of Police \citep{police}. \\

Research in computer science is developing semantically-oriented techniques to analyze fiction. \cite{character_country} presented a method to extract social networks from litterature which allows the application of Social Network Analysis techniques on it. \cite{movie} presented a method to extract a social network from movies. Automated methods that analyze texts of fiction also produce metadata that help to analyze them. For instance, \cite{original} extract the social network of novels but also count the mean distance between two dialogs in the novel. This measure produces meaningful results when it is used to classify novels. Social networks can be seen as metadata with the particularity of being present in any fiction no matter the support of this fiction. Other metadata are only measurable in movies, novels... \\

This master thesis consists firstly in the development of software that extracts social networks and other metadata from novels and movie scripts. Secondly, it consists of the analysis of the topology of the extracted networks. The software has been originally developed during another master thesis \citep{original_thesis} and further advancement have been achieved in \cite{original}. It was initially only working with novels. For this reason, I will focus on the modifications that I have made and the evolution of the state of the art since this period. The global way the software works will also be explained briefly. \\


\chapter{Network theory}
\begin{table}
\center
\scalebox{0.7}{%
\begin{tabular}{|c|c|}
\hline
Examples & Applications \\
\hline
Friendship networks & College/school students Organizations or web(Facebook, MySpace, etc.)\\
Follower networks & Twitter, LinkedIn, Pinterest, etc.\\
Preference similarity & networks Pinterest, Instagram, Twitter, etc.\\
Interaction networks & Phone calls, Messages, Emails, Whatsapp, Snapchat, etc.\\
Co-authorship networks & Dblp, Science direct, Wikibooks, other scientific databases, etc.\\
User-user citation networks & Dblp, Science direct, Wikibooks, other scientific databases, etc.\\
Spread networks & Epidemics, Information, Rumors, etc.\\
Co-actor networks & IMDB, etc.\\
\hline
\end{tabular}}
\caption{Example of social networks \citep{SNA_Overview}}\label{SNA_Exemple}
\end{table}

Before extracting or analyzing any social networks, let's introduce the notion of social networks and the basic concept related to network theory.
Social networks are defined as ``a network of social connections and personal relationships between people'' \citep{SNA_Overview}. Examples are given in table \ref{SNA_Exemple}.
In social network analysis, relationships between people are represented using a network to analyze them with mathematical tools provided by network
and graph theory. ``It helps in understanding the
dependencies between social entities in the data, characterizing
their behaviors and their effect on the network as
a whole and over time.'' \citep{SNA_Overview}
We should note that in computer science, the word network and the word graph have the same meaning. The choice of these words usually depends on the application. For instance ``social networks'' are never called ``social graphs''
but it would represent the same concept. The word ``graph'' is more used in mathematics while the word ``network'' is most common in engineering \citep{network_theory}. In this work, the word network will be used most of the time to avoid confusion.


\section{Network definition}
\begin{figure}
\centering
\includegraphics{diestel_graph.png}
\caption{Network of Nodes $= 1,...,7$ and links $= \{(1, 2), (1, 5), (2, 5), (3, 4), (5, 7)\}$ \citep{diestel}}
\label{diestel_graph}
\end{figure}

Network theory is the study of networks. A network or a graph is defined mathematically as a pair of sets $G = (N, E)$ such that $E \subseteq [N ]^2$. Concretely it means that an element from the second set should be a tuple of 2 elements from the first set.
Graphs are usually represented with points symbolizing elements from the first set linked by lines representing elements from the second set. You can see an example of this representation in figure \ref{diestel_graph}. In network theory, elements from the first set are called ``nodes'' and elements from the second set are called ``links'' or ``edges''. If for any pair $XY \in N$, the link $(X,Y) = (Y,X)$ then the graph is called undirected. This is the most common type of graph. Other graphs are called ``directed'': their edges are directed from a sender to a receiver. In this work, we will focus on undirected graphs. \citep{diestel}\\

In many applications, values are associated with nodes or links of the network. Often, a numerical value is associated with links and called weight. Those values are considered to be part of the network even if it is not in the mathematical definition.


\section{Network key notion}

Some key notion are needed to understand this measure:
\begin{itemize}
\item \textbf{Neighborhood} : Two nodes are defined as \textit{neighbors} if they are linked on a graph. The nodes $u,v \in G$ are neighbors if the edge $(u,v) \in G$. The \textit{neighborhood} $N_i$, of a node i is the set of nodes that are neighbors with the node i.

\item \textbf{Degree}: The degree, $k_i$ of a node i is defined as the size of its neighborhood, which corresponds to the number of edges that are incident to the node i.


\item \textbf{Path}: A path is a sequence of nodes such that for all pairs of consecutive nodes $i,j$: the edge $ij \in E$ which means that the nodes are linked by an edge. The \textit{Shorter Path} between two nodes is a path binding the 2 nodes such that there is no shorter path binding them. The notion of distance of a path can be defined as the sum of the weight along this path or as the number of nodes bounded by the path. The length of a shorter path is named \textit{Geodesic Distance}. It can not be measured on disconnected nodes.

\item \textbf{Connection}: Two nodes of a graph are connected if there exists a path in the graph that binds them. The nodes don't have to share an edge. To avoid any confusion, the nodes that share the same edge are here referred to as linked. A graph is connected if all nodes from the graph are connected.

\item \textbf{Clique}: A k-clique is a set of fully connected k nodes, a set of nodes $K$ such that there is an edge $xy \in E \forall x,y \in K $.

\item \textbf{Eccentricity}: The eccentricity,$\epsilon_i$, of a node i is the maximum size of the shortest path that binds the node with another node of the graph. It can be seen as the distance between the node and the further node from the graph. It can only be measured on a connected graph.

\end{itemize}
\citep{diestel}
\section{Network: Measure}
\label{measure}
There are multiple measures characterizing networks. I will give here the measures that are commonly used in social network analysis. Further explanations about the measures used in social network analysis are available at \cite{SNA_Overview}.

\subsection{Mean degree}
The mean degree is the mean value among the degree of all nodes. It can be computed more easily with the formula $\mu = \frac{|N|}{|E|}$ where $|N|$ is the total number of nodes and $|E|$ the total number of edges. It represents how many nodes of a network tend to share links or how much the network is connected.

\subsection{Clustering coefficients}
%The strength is a measure near from the degree that exists for weighted graphs only. It corresponds to the sum of the weights of all edges incident to a node.
\begin{equation}
C_i = \frac{2 \cdot |e_{jk}|}{k_i \cdot (k_i - 1)}: j, k \in N_i, e_{jk} \in E
\label{clustering_local}
\end{equation}
Different clustering coefficients may be computed.\\
The local clustering coefficient, $C_i$, of node $i$, is given by the formula \ref{clustering_local} where E is the set of edges and $N_i$ is the neighborhood of i. It represents how much the node is part of a connected neighborhood or how much the node is close to being part of a clique. In a group of friends, this measure is usually close to 1 as most of the friends know each other. In a network that represent love relationships, most of the nodes will have a clustering coefficient close to 0 as romantic partners of an individual don't tend to share such relations between each other.\\

As there are multiple global measures of graph clustering named ''global clustering coefficient'', we will give here the most popular. The first one has been given by \cite{globalClustering1}. It's computed by taking the mean local clustering coefficient among all nodes. It is also named the mean local clustering coefficient. \\

\begin{figure}
\centering
\includegraphics{graph_clustering.png}
\caption{Graph of transitivity 1/3. They are 3 potential triangle: 0-4-7, 0-7-1 and 1-4-7. Only 0-4-7 is a triangle. }
\label{transitivity}
\end{figure}

The second global clustering coefficient is taken by counting the number of triangles in the graph divided by the number of ``potential triangles''. A ``potential triangle'' is a set of 3 vertices such that one vertex is linked to the 2 others vertices. An illustration of this is given in figure \ref{transitivity}. This measure is also called transitivity and will be named in that way in this master thesis to avoid any confusion. \\

Both of these measures are related to the probability of clique formation and transitivity. Network with high clustering coefficient tends to have a cluster of nodes connected between them. Pair of nodes connected by a third node tend to be also linked by an edge. This is why the second measure is called ``transitivity''.\\

\subsection{Radius and diameter}
The diameter of a graph is the greater eccentricity of its nodes. It can be used to know how far could potentially be actors in a network. The radius of a network is the smaller eccentricity of all its nodes. A small eccentricity indicates that a particular node is near all the other nodes. However, both of those measures are very sensitive to outliers and not very robust. As the eccentricity, it can not be measured on disconnected networks.

\subsection{Average path length}
The average path length \citep{path_length} or average geodesic distance is the mean distance of the shorter path between each pair of nodes from a connected network. It measures the distance between 2 random actors of the network. This measure can be compared with the radius and the diameter which gives close information but unlike them, it is considered robust.

\section{Networks characterization}
There exist a lot of networks. Of course, a lot of them have human origins such as the internet network, electrical networks, or social networks. But the notion of networks can also be used to observe natural processes as the set of veins of a body or the relation between metabolic and protein. Some networks seem to build in a structured way, some of them seem random. Some networks have been humanly designed, some of them seem to evolve from themselves. To characterize networks we use topology and models.\\
\begin{figure}
\centering
\includegraphics{lattice.png}
\caption{Square Lattice. \citep{complex_networks} }
\label{lattice}
\end{figure}

Some networks have a very regular and easily recognizable topology such as lattices, stars, circles. An example of it is available in figure \ref{lattice}. We also saw fully connected graphs on the previous question. However, most of the networks don't have a such regular topology. especially social networks. The structure of social networks is not decided in advance, it's the product of continuous growth due to local interactions among individuals. We can oppose regular graphs to random graphs, graphs that are the result of random growth. Of course, some graphs are also the result of a process that includes randomness but can not be modeled using random graphs.\\
%%todo explanation model
\begin{figure}
\centering
\includegraphics{normal_distrib.png}
\caption{Random graph: degree distribution}
\label{random}
\end{figure}

\begin{figure}
\centering
\includegraphics{erdos.png}
\caption{Example of random graph\citep{erdos_image}}
\label{erdos}
\end{figure}

\subsection{Random networks}
\label{random-section}
2 popular models are used to represent the build random network. In the first one introduced by \cite{erdosRandom}, given a number of nodes N and a probability p, a graph is constructed with N nodes and each potential edge is added with a probability p. In average the number of edge that appears is $N \cdot (N-1) \cdot p$ with $ 0< p <1$. The second model \citep{gilbertRandom} l takes a number of nodes N and a number of edges M as input. The M edges are chosen randomly without replacement in the set of $N \cdot (N-1)$ potential edges. Those models are asymptotically the same. The first model gives a variable number of edges but for big values of N, the networks generated with those models should share a common topology. This topology is mainly characterized by a number of edges approximately constant for a given couple (N, p) and by a distribution of degree. Figure \ref{random} shows the plot of the degree distribution of a random graph obtained with the second model. The graph has 10000 nodes and 20000 edges, so the mean degree of its node is $\frac{2 \cdot E}{N} = 4$. the plot includes a normal distribution centered on 4. The degree distribution of random graphs follows normal distributions. An illustration of a random graph is also given on \ref{erdos} The mean path length of random networks is small and grows logarithmically with N. Due to random connection, nodes are likely to share connections with very distant nodes. Due to these random connections, their clustering coefficients are very small.\\

\subsection{Small-world networks}
\label{sm-section}
Small-world networks are another family of networks that presents elements of randomness. Initially, the goal of this classification was to represent networks that are highly clustered as latices but have an irregular topology and have a very short average path length between their nodes. A lot of social networks respond to these properties. For instance, networks of friends are highly clustered: people sharing common friends are likely to be friends. Of course, they are not regular as they evolve randomly and their average path length can be surprisingly small: \cite{milgram} have shown that the median number of intermediary needed to connect two randomly chosen people is six. Random networks don't have those properties as links are randomly added, all nodes have the same probability to share an edge. Some regular networks such as lattices are also highly clustered but they have a very long mean path length: as each vertex is only connected to its nearest neighbors, a path needs to go through a lot of clusters of neighbors before joining an opposite node. \citep{complex_networks} \\

\begin{figure}
\centering
\includegraphics{small-world.png}
\caption{Construction of a small-world network \citep{small-world}}
\label{small-world_pictures}
\end{figure}


The Watts-Strogatz model for building small-world networks has been given by \cite{globalClustering1}. The networks of N nodes, $N \cdot 2 \cdot k$ edges are constructed by the following algorithm taking a probability p as input:
\begin{enumerate}
\item A lattice of N site is drawn, each drawn being connected to its 2k neighbors.
\item For each node, each edge is removed with a probability p.
\item For each edge removed on a node, a new edge is added linking the node with another node randomly chosen. Steps 2 and 3 may be executed at once.
\end{enumerate}
After this construction, a network is obtained with a high clustering thanks to the initial lattice structure. But the edges added in the last step allow to connect groups of neighbors that are far from each other and reduce the mean path length. The construction of the network is illustrated in figure \ref{small-world_pictures}. An initial graph is shown on image (a) and the following image shows the network after the removal and additions of some links. The networks constructed with this model are characterized by being connected and having an almost constant degree for each node. Others models have been given for small-world networks by following the same intuition of combining lattice with randomness and long-range link. A common property of those networks is that the mean-path length grows logarithmically with N similarly to random graphs.\citep{small-world, complex_networks}

\subsection{Scale-free networks}
\label{scale-free-section}
\begin{figure}
\centering
\includegraphics[scale=0.5]{Degree-distribution-of-random-and-scale-free-networks.png}
\caption{Comparison between the degree distribution of a random network- small world network and a scale free network \citep{scale-free_degree}}
\label{scale-free_degree}
\end{figure}

Scale-free networks are a third type of network that presents elements of randomness. It has been introduced by \cite{scale-free}. They are usually defined as networks having degree distribution following power laws: $ P(k) \approx c \cdot k^{-y}$. An example of such distributions is given in figure \ref{scale-free_degree}. It means that a very small number of nodes present very huge connectivity. This property is present in different networks such as the world-wide-web \citep{www} or the web of human sexual contacts \citep{sexual}. The usual constructions of scale-free networks follow two principles. Firstly they \textit{grow} and during this growth new nodes are added and linked with existing nodes. Secondly, the creation of new nodes is done with \textit{preferential attachment}: nodes have always more chance to be connected to nodes that already have a lot of edges. Some authors consider that those principles are requirements for a network to be scale-free, having $k$ parameters between 2 and 3 can also be a requirement \citep{sf_rare}. The growth and the preferential attachment are responsible for the creation of nodes having a lot of connections that are called \textit{hubs}. Hubs have a key role in such networks. For instance, a big part of the circulation in the internet network goes through those hubs and the removal of several hubs would lead to a major increasing of some path-length and could also lead to some disconnections between sets of nodes in the network \citep{general_scale-free}. Finally, according to \cite{SMVSSF}, scale-free networks tend to have clustering coefficients smaller than small-world networks, as nodes that are not hubs are not likely to be directly connected. \citep{general_scale_free2}\\

\begin{figure}
\centering
\includegraphics[scale= 0.6]{scale-free.png}
\caption{Comparison between (a) a random network and (b) a scale-free network \citep{complex_networks}}
\label{scale-free_pictures}
\end{figure}

The most popular method for constructing scale-free networks has been given by \cite{barabasi_model}. The algorithm depends on two parameters: a number of node N, an initial number of node $N_0$ and a number $m \leq N_0$.\\
\begin{itemize}
\item Initially, a fully connected network of size $N_0$ is constructed.
\item Iteratively a new node is added to the network. m edges are added to the node. An edge is connected to an existing node with a probability $p = \frac{k_i}{\sum_{j} k_j}$.
\item The algorithm ends when $N -N_0$ nodes have been added.
\end{itemize}
An example of a network obtained by this algorithm can be seen in figure \ref{scale-free_pictures}. As previously explained, the main characteristic of scale-free networks is their degree distribution following a power law. \cite{globalClustering2} also showed that the clustering coefficient tends to zero if $ 1 < y < 2$. However scale-free networks can have high clustering coefficients for bigger values of y. The mean path length of this model increases in $\frac{\log{N}}{\log{\log{N}}}$ with the number of nodes N.\\


\subsection{Comparison between types of networks}

\begin{figure}
\centering
\includegraphics[scale= 0.6]{Regular-random-small-world-and-scale-free-networks.jpg}
\caption{Comparison between different type of networks \citep{img_comp}}
\label{comparison_networks}
\end{figure}

As previously explained social networks are almost never regular due to their mechanism of growth and evolution. However the topology of different social networks can have different properties: They can share properties of random, small-world, and scale-free networks. There are defined in such a way that a network can present both properties. Erdos-Rényi random networks are small-world network as they mean path length growth with $\log N$ and \cite{xs} classify Barabási and Albert as ``ultra small-word'' because they mean path length grows with $\frac{\log{N}}{\log{\log{N}}}$ as we saw in the previous section. Networks may be classified in topologies using all the measures that we explained in section \ref{measure} and visualization tool. Figure \ref{comparison_networks} shows a network of each type for visual comparison.




\chapter{Social network construction}

In this section, I will briefly explain what are the main steps executed by the software to extract social networks and metadata from novels or scripts. The added modifications of the initial program will be more detailed. The bigger change concerns the extraction of characters from novels. Also, the original software was only analyzing novels, some adjustments have been made to extend it to movie scripts. The state of the art is not presented for parts that don't have been deeply modified. Every information about it are available at \cite{original} and \cite{original_thesis}.

\section{Assumption and conception of the social network}
There are multiple ways of constructing a social network from a text. Especially because there are multiple ways of analyzing the structure of the narrative. \cite{original} choose to see a narrative as a succession of events. The text is composed of a series of \textbf{conversations} that involve a set of characters. Each conversation can be subdivided into a succession of mini-event that are called dialog. In a \textbf{dialog} a person chosen in the set of characters involved in the conversation will address a message to the other characters from the set, the \textbf{audience}. The person that sends the message is called the \textbf{speaker}. Also, all sentences that are out of dialogs are called \textbf{context} and linked with the following conversation or the one that is currently happening. Sentences of context can be located between dialogs from the same conversation. Characters that appear together in a conversation are linked in the social network with a weight that corresponds to the number of conversations they are both in.

The narrative is also divided by \textbf{scene breaks}. It represents an additional cut where all the previous context should be thrown up. In novels, scenes-break are used to introduce new chapters while in movie scripts, scene breaks are directly annotated.

\section{Text analyzed}
Most of the novels analyzed in this work have been provided by \cite{original}. They have been selected to represent a variety of popular series and some classic novels. They choose to select series to observe if social networks from novels being part of a series are sharing common properties. I've added to it the novel ``Pride and Prejudice'' to compare my result of character extraction with the results of \cite{character_meta}.
Various scripts of movies have been added to compare social networks developed in literary fiction and movies. There is both original scenario and adaption from books in order to allow comparison between those type of movies. Adaptation of analyzed novels has been added when they were available. This was not always the case as the scripts provided on most websites are very badly formatted which makes them unusable in the program. The list of text used is available on \ref{texts}.


\begin{table}
\center
\scalebox{1}{%
\begin{tabular}{|c|c|}
\hline
Novel & Script \\
\hline
\multicolumn{2}{|c|}{Pride and Prejudice}\\
Harry Potter 1$\rightarrow$7 & Harry Potter 1-2-3-4-6-7 \\
A song of Ice and Fire 1$\rightarrow$5&Black Panther\\
The Lunar Chronicles 1$\rightarrow$3 &Thor Ragnarok\\
His Dark Materials 1$\rightarrow$ 3& Blackkklansman\\
The Mortal Instruments 1$\rightarrow$6 & Boyhood\\
The Liveship Traders 1$\rightarrow$3 &Halloween\\
The Wheel of Time 0$\rightarrow$14 & Joker\\
The Rain Wild Chronicles 1$\rightarrow$4 & Jurassic Parc 1$\rightarrow$3\\
&Lord of the ring 1$\rightarrow$3\\
& Shrek 1 and 3\\
&The devil wears prada\\
&Titanic\\
& Alien 1$\rightarrow$3\\
\hline
\end{tabular}}
\caption{Novels and script whose social network has been extracted. `Pride and prejudice' has been used under the form of the novel and under the form of the adaptation's script. In total there is 46 novels and 25 scripts.}
\label{texts}
\end{table}




\section{Implementation}

Most of the NLP functions used on this software come from the library pattern \citep{pattern} only available on python 2. As new tools have been developed in python-3 libraries, the choice has been made to pass the code to python 3.
To keep the structure of the code developed with the tool pattern, a python 3 branch of the library has been used. The branch is still in development and every function is not runnable but I manually fixed the function needed to run the software. My fork of the library is available at \textit{https://github.com/antheymans/pattern}.\\

To use new functions that don't exist on the pattern library, the choice has been made to use the Spacy library \citep{spacy}. This library developed by MIT has the advantage of being well-documented. This is completed by the use of NLTK \citep{NLTK} which gives access to a wide variety of data and corpus for NLP. A lot of state-of-the-art articles use the Standford CoreNLP package \citep{CoreNLP} which also haves all the state-of-the-art tools. However, this package is written in java. There exists a python adaptation of it but it is poorly documented and doesn't include all the tool of the java version \citep{CoreNLPPython}.\\


\section{Formatting of input}
To be used as input of the program, a narrative should be in the form of a text and transformed in order to follow a set of rules. The program has been made to exploit the information available in novels and movie scripts but a narrative following any other format can be used in the program if it follows the rules.

\begin{itemize}
\item The text should be stored in a \textit{.txt} file with an \textit{utf-8} encoding.
\item All information located in the document should be part of the narrative. The title can be kept but any preface or thanks from the author will be considered as being part of the narrative.
\item All dialogs should be delimited by double-quotes. Double quotes can not be used for other purposes. All double quotes present in the text should be replaced with simple quotes.
\item If consecutive dialogs belong to the same conversation and have the same speaker, they should be concatenated. There is an exception to this rule is there is a context between those dialogs.
\item A new scene should be represented by an empty line. No other empty lines are authorized.
\item If the speaker of a dialog is annotated, it should be indicated in uppercase on the previous line. The name of the speaker should be preceded by ``\_'' and followed by ``:''.\\
For instance: \\
\_TINTIN:\\
``Milou, go outside!''\\
\end{itemize}

The formatting is made manually using regex. A script has been created to transform automatically scripts having the most common structure but it often requires minor manual adjustment.

\section{Preprocessing of the text}
Initially, all the sentences of the text are extracted, parsed, and divided into chunks. Annotated speakers are extracted and linked with the related dialogs. Sentences belonging to the same dialog are grouped. The location of scene breaks is also stored to later cut the conversations at this point. The sentiment associated with each sentence is also computed using 2 scores: a measure of polarity that tells how much the sentence is negative or positive and a measure of subjectivity that tells how much the sentence tends to give a personal opinion.

\section{Construction of conversations}
To group dialog in conversation, the program should be able to decide if 2 consecutive dialogs from a scene belong to the same conversation. The difficult part is that there are often sentences of context between dialogs of a conversation. The method developed by \cite{original_thesis} uses the size of the spacing between dialogs to perform this task. It builds conversations as a list of dialogs having an associated list of non-dialog sentences. The second list is called the context of the conversation.\\
The program begins by counting the number of spacings separating each dialog. The spacing between dialogs belonging to the different scenes is not taken into account. From the number of occurrences of each value of spacing, a threshold value will be chosen. Dialogs separated by a spacing above this threshold value are not part of the same conversation. The threshold value is chosen using the following formula where \textit{frequency} is the function that counts the number of occurrences of a spacing value.

\begin{equation}
\begin{split}
treshold = max\{spacing | frequency(spacing) > 100 \\
\vee (frequency(spacing) >= 10 \\
\wedge frequency(spacing) >= frequency(spacing + 1) \cdot 2 \\
\wedge frequency(j) > frequency(spacing) \forall j \in [1,spacing])\}
\end{split}
\end{equation}

The formula has been empirically chosen by \cite{original_thesis}.\\

A conversation ends with the last dialog of the scene or with a dialog being separated by its successor by a spacing bigger than the threshold value. All sentences of context located in a conversation or between the current conversation and the previous one are grouped. This group is the context of the conversation.\\

\section{Character identification}
Character extraction is a major task of social network extraction. ``Character identification consists in detecting which characters appear in the considered narrative, and when exactly they appear in this narrative'' \citep{fiction}. It can be divided into 2 independent sub-tasks:
\begin{enumerate}
\item The extraction of a list of characters.
\item The detection in the text of character appearances.
\end{enumerate}

The first sub-task will be deeper analyzed on this work, as a new detection system has been developed to improve the result from \cite{original} on novels. On this part, scripts and novels need different processing as scripts have annotated speakers for most of their dialogs while novels contain more context information that can be used to extract characters.


\subsection{Character extraction in novels}
According to \cite{fiction}, characters in novels may appear in the form of a proper noun, a pronoun, or an anaphoric noun phrase. Example are given on figure \ref{appearance_type}.
We can add a distinction between proper nouns and proper names even if they are sometimes used as synonyms:
In this work, we use the definition of proper names and proper nouns given by \cite.
According to this definition, proper nouns are single capitalized words while proper names are a single word or a group of words that designates an entity.
Proper names composed by a single word are both proper names and proper nouns, for instance: "Harry".\\

In this work, characters are only detected when they are in the form of proper names which includes proper nouns.
This choice is motivated by the fact that characters will be later connected when they are mentioned in the same conversation.
The cost of this simplification is the loss of smaller characters that appears only under the form of an anaphora.
I considered that in most cases, a character taking part in a conversation is mentioned at least once under the form of a proper name.
In our situation, the first step of \textit{character identification} on written support is the extraction of names that represents the characters and the linking of aliases (names that refer to the same character).
Once all extracted names are bound with a character, each occurrence of a name in the story signals the appearance of the associated character.
As the task of extracting a set of proper names and binding aliases is error-prone, some authors decided to do it manually \citep{agarwal-etal-2013-automatic}.
\cite{he-etal-2013-identification} proposes to build automatically a list of characters from the Wikipedia page of novels but this method has the disadvantage to focus only on main characters and
being dependent on external information unavailable for some stories.
Here we will focus on automatic methods because they can be used on many different texts with minimal pre-processing.\\

\begin{table}
\center
\scalebox{0.7}{%
\begin{tabular}{|l|l|l|}
\hline
\textbf{Proper Names} & \textbf{pronoun} & \textbf{anaphoric noun phrase} \\
\hline
\textbf{Robert} is eating. & \textbf{He} is eating. & \textbf{The man} is eating.\\
``\textbf{James}, tell me what happened?''. & ``\textbf{You}, tell me what happened''. & ``\textbf{Old man}, tell me what happened''.\\
\hline
\end{tabular}}\\
\caption{Different type of characters appearance}\label{appearance_type}
\end{table}


\subsubsection{Comparison between the use of all proper names over a limitation to proper nouns}
A major modification of the program concern the first step of the character identification process.
The original process was only considering that a character could be represented by a proper noun and was linking nouns that appear together more than 1 times over 3
in order to bind first name and last name.
But using only proper nouns among all proper names is a simplification that makes the program lose a lot of information.
The use of proper names makes the binding more complex but also allows to use of more information to perform this binding.
The current state of the art contains methods to perform this task. \\

\begin{table}
\center
\scalebox{0.7}{%
\begin{tabular}{|l|l|l|}
\hline
\textbf{chunk} & \textbf{names extracted using proper names} & \textbf{names extracted using proper nouns} \\
\hline
Ron and Hermionne & Ron AND Hermionne & Ron\\
you Mr. H. Potter & Mr. H. Potter & Potter\\
dear Harry Potter & Harry Potter & Harry OR Potter \\
James Potter& James Potter & James OR Potter \\
yer brother Charlie & Charlie & Charlie\\
\hline
\end{tabular}}\\
\caption{Different type of characters appearance}\label{properNounsNames}
\end{table}


The fact that proper nouns are only composed of a single token makes a perfect binding of names designating the same character impossible.
The pairing is needed to link the first names and last names of characters but in some cases, multiple proper names that should not be linked appear in the same chunk.
Here are some common mistakes in character extraction with examples from the method of \cite{original} used on the novel Harry Potter 1.
\begin{enumerate}
\item \textbf{When both the first name and the last name of a character are used to identify a character, they are not paired}: "Harry" and "Potter" are labeled as different characters.

\item \textbf{When multiple characters share the same first name or last name, if the linking is made they will all be clustered as a single character}: the names referring to the 8 characters of the "Weasley" family are mixed in 4 clusters. Each cluster is composed of aliases referring to 2, 3, or 4 characters.

\item \textbf{Some characters are referred to with proper nouns that should not be used for pairing}: "Mr" is paired with "Dursley" and "Weasley" because the text often refers to "Mr. Dursley" or "Mr. Weasley". It causes the clustering of unrelated words. The same problem appears with other titles like "professor".

\item \textbf{Some chunks contain multiple characters}: The algorithm links the chunk to a sinHermionecter.
For instance: "Ron and Hermione", "Mr and "Mrs. Weasley" or "Fred and George" are each time linked to a single character.
\end{enumerate}

\subsubsection{Name Entity Recognition}
The task of labeling groups of words as Entity is called Name Entity Recognition (NER).
Those entity includes \textit{person}, \textit{location} and \textit{organisation} \citep{libraries}.
This is the most common way to extract characters' names from a novel.
The best NER methods are supervised or semi-supervised and trained with annotated datasets of news, text from social media, or biomedical data \citep{NER_survey_recent}.
This decreases their performance in novels, especially novels from fantasy or the older ones \citep{NER}.
Unsupervised methods typically rely on rules and domain-based knowledge, which makes them completely domain-dependent.
POS-tagger may be considered as a naive program of NER.
The original software \citep{original} was extracting all words labeled as proper names by a POS-tagger with the major issue of considering only single-word nouns
while in \cite{quoted}, proper nouns are tagged using a POS-tagger and contiguous proper nouns are considered as proper names.
\cite{character_meta} also extracts subjects of verbs present in a dataset of verbs strongly associated with ``person'' entity.
This technique allows detecting anaphoric nouns and not only proper names. \cite{ structure_clustering} store the number of times that words are classified at location or person,
so words that are likely to be locations are removed from the location list.
Pattern the NLP library of python that is used in the software doesn't have any NER module.
Spacy, another NLP library of python has an available module that performs NER using "Conditional Random Fields", a statistical model that uses supervised learning.
Pre-trained models are available but the model could also be trained manually with an annotated dataset.
The most common tool for NER is the Stanford Named Entity Recognizer (NER) which is only available on java. For practicability reasons, it has not been considered in this work.\\


\subsubsection{Unification of Character Occurrences}
Unification of Character Occurrences is the task of unifying all mentions of the same character in a narrative \citep{fiction}.
When only proper names are considered, this task can be simplified into Alias Resolution:
the linking of all names that refers to the same characters and the differentiation of names that refers to different characters \citep{book_social}.
The binding of names can be done using a measure of string similarity, set of rules, or using meta-information of strings such as an inferred gender.
In multi-stage methods, proper names are divided between clusters, each of them being associated with a single character. The clusters are merged following a sequence of conditions.
Multiple methods have been developed to solve this task with their specificity without that one method stands out from others.\\

The original software \citep{original} was linking proper nouns that appear together 1/3 of the times to link the first name with the last name with the major inconvenience of binding different characters sharing the same first name or last name and leaving unbound names and last names of characters that are more frequently called by only one of those words.
However, most of the state of the art methods focus on proper names:
\cite{delete5} discards all proper names that appear less than 5 times, then try to bind multi-word names between them before binding them with single words nouns.
\cite{structure_clustering} also classify names into multiple classes and apply different rules to those classes.
They also link first names with initials and corresponding nicknames from a dataset.
\cite{character_meta} propose to bind names that share nouns except in some cases, such as names sharing a last name but having a different first name.
\cite{variation} proposed a method to bind entity representing art object by generating variations of proper nouns and linking them with names corresponding to those variations,
this method have been applied on characters detection in novels by \cite{quoted, character_meta}.
In \cite{delete5, structure_clustering, quoted}, a gender is labeled to proper names using a list of male and female first names and gendered titles.
It is used to avoid merging clusters of names having different genders.
\cite{ structure_clustering} a sliding window is also used on the text to detect pronoun near names and use it to infer the name gender.
It ends by removing infrequent characters, characters whose total number of apparitions aliases is smaller than a threshold.
This should reduce the number of ``false positive'' characters (cluster of names that are not related to a character), at the cost of minor characters.
\cite{delete5} draws the conclusion that all methods are error-prone and that the difficulty to obtain annotated data on this task makes any comparison
between the different methods very difficult.
Even with a dataset containing all characters present in a narrative, the presence of multiple aliases would make the evaluation of the character extraction very difficult.\\

Some methods also use co-reference resolution tools to link characters' mentions between each others \citep{character_meta}.
Coreference resolution tools are programs that automatically cluster mention in texts that refers to the same entity.
They do it using neural networks and are especially used to link names with pronouns or anaphoric noun phrase \citep{coref_deep, coref_deep2}.
However, its benefits are limited in this work as we don't need to resolve all pronouns, identify characters' names in conversation is sufficient to build a social network.\\

\subsection{Proposed method of character extraction in novels}
As explained in the previous section, the method here extracts proper names, the extracted names are composed of multiple words including honorifics.
Anaphoric noun phrases are ignored.
The method consists of a multi-pass algorithm that passes 2 times over chunks to extract a list of names, classify them and then pass 5 times over the set of names to bind aliases.

\subsubsection{Proposed system of Names Entity Recognition}
\label{section:NER}
To find a NER method for character extraction in novels, we relied on some hypotheses.
Names from fiction have the particularity to be invented to be easily recognizable by the reader.
We can rely on the hypothesis that in most novels, there is no namesake person. An exception to this hypothesis is the 2 characters named ``Barty Croupton'' in Harry Potter.
An interesting point is that the objective of this unusual name-sharing was to confuse the reader.
Also, we consider that characters from novels should be labeled as persons, so we are only looking at the NER system capacity to distinguish persons from other entities.
We will later accept some entities as ``speaking objects'' as characters.
But it has been considered that most of them have specific nouns that are likely to make a NER system to label them as characters
and the remaining ones should be minor in the narrative. So if we miss one of them, it's not considered a major issue.\\

As explained in the state of the art, a python library, Spacy, provides a tool for the task of Named Entity Recognition.
However, this tool has not been trained specifically with novels nor for the task of extracting characters' names from a text.
It doesn't detect honorifics and works as a ``black box'' which gives sometimes incorrect results.
For instance in the book ``Harry Potter 1'' the tool detect as characters: 'Harry bellowed', 'Harry anxiously', 'knew yeh didn', ' baker', `yer meddlin', 'Happy Birthday Harry'.
It seems that interjection such as ``yer'' or ``yeh'' are interpreted as nouns and a lot of verbs or adjectives are seen as part of names like with ``Harry bellowed''.
Also, the tool doesn't make a difference between proper nouns and anaphoric nouns such as with ``baker''.
This is an issue as anaphoric noun phrases lose their meaning out of their context and considering them as character names could lead to major confusion.
For instance the anaphoric noun phrase ``the father'' could represent a lot of characters according to the context.
For all those reasons it has been chosen to avoid working with this library. \\

A Named Entity Recognition method has been designed to extract characters' names from novels.
This technique uses a POS-Tagger to extract proper nouns from the text and several collections of proper nouns commonly used in English to isolate characters' names.
Then proper names are extracted from chunks containing a valid proper noun if it is not the head of a sentence.
The collection of words contain a list of countries, nationalities, honorifics (classified following the related gender), stop-words, profanities,
words related to time, and words related to the academic domain.
In this method, a proper noun is considered as \textit{valid} if it begins with a capital letter but is not composed with capital letters only.
The assumption has been made that proper nouns contain more than one letter.
The first words of sentences are not kept as they are capitalized and so they are more likely to be wrongly classified as proper nouns.
The assumption is made that proper nouns will appear several times and that at least one of those appearances will not be at the beginning of a sentence.\\

First of all the POS-tagger is passed on the headword of all chunks to extract proper nouns.
The POS-tagger used is the one developed by the python library pattern which classifies proper nouns whether they are related to a location or not.
If a word is valid and not labeled as a location, the algorithm check that it doesn't appear in any of the collection of English words and that
it is not the first word of a sentence. Proper nouns considered related to character names and proper nouns related to locations are saved with the count of their appearance.
Secondly, the algorithm check that words labeled as location doesn't appear in the list of proper nouns.
In such cases, the word will be removed from the list of proper nouns if it appeared more often as a location than as a name.
The final step of the Named Entity Recognition method consists of building proper names from proper nouns.
All chunks containing a proper noun are isolated.
Then all sequences of consecutive valid proper nouns are extracted and considered as proper names.
For instance from the chunk ``Mr. Harry Potter and Ron'' 2 proper nouns are extracted: ``Mr. Harry Potter'' and ``Ron''.
The proper names are registered with the count of their appearance. After this step, all proper nouns that have not been used in any proper names are deleted.\\

In this method, many restrictive conditions are put on proper nouns extraction.
But the way nouns are extracted implies that if a noun is extracted one time, he will be considered each time as a proper noun.
For this reason, the addition of new nouns should be very cautious.
The hypothesis is made here that a frequent character's noun will appear at least once in a situation that allows to identify him as a character's noun in an unambiguous manner.
On the original program, only a few conditions are observed and the result shows that most of the extracted characters don't refer to actual characters of the novel.
This observation will be explained more formally in the section \ref{performance}.

\subsubsection{Proper names classification}
\label{section:classification}
All the extracted proper names are classified following their gender and their form to make easier the alias resolution.
The classification of genders is also used to produce gender-related information about the topology of the network.
Firstly all the names are parsed using the python tool \textit{HumanName} from the library {NameParser}.
It separates words contained in a name in a list of honorifics, first name, and last name.\\

To infer the gender, the algorithm uses a list of honorifics and a list of first names classified by gender.
The gender of names containing the first name from the list of first names or an honorific from the list of labeled honorifics will be assigned.
If multiple words in the name are related to different genders, the majority vote is used.
After this phase all names are labeled as \textit{male}, \textit{female} or {neutral}.\\

Then a category will be assigned to each names following their forms:
\begin{enumerate}
\item The first category contains names that have at least an honorific, a first name, and a last name.
\item The second one contains names with a first name and a last name but no honorific.
\item The third category contains names with an honorific and a first name but no last name.
\item This category contains names with an honorific and a last name but no first name.
\item The fifth category contains the remaining names.
\item If the first name of a name is not in the list of proper nouns and doesn't respect the criteria from the previous section to be labeled as a proper noun,
the name is considered as an error and is removed.
\end{enumerate}

\subsubsection{Alias resolution}
\label{section:alias}
The alias resolution process consists of a multi-pass algorithm that firstly creates a primary link and secondary link between all names,
then transforms secondary links into primary links in some cases. After this linking phase, clusters are build to represent a character.
Each cluster consists of names connected between them by a path of primary links.
The most used name of the cluster is called the head of the cluster and is used to represent the associated character in the social network.
In the following explanations, I will use the expression ``compatible genders'' between 2 names,
which means that the gender assigned to those names doesn't prevent them to point the same character.
Concretely they have the same gender or one of them is neutral. To be connected, names have to have compatible genders.
Once two names are linked by a primary link, if one of them was neutral, its gender will be inferred from its neighbor.
In such situations, the neutral name will delete all its connections with words of the opposite gender.
In the following explanation, I will also speak about "primary-connection" or secondary"neighbors" to speak about names connected using a path of primary link
and names neighbors from each other by a secondary link. \\

During the first pass, all first names used by names of classes 1 and 2 are taken one by one.
Diminutive and nicknames associated with a first name are looked at in the set of proper names.
Then all proper names that possess that first name, a diminutive, or a nickname are grouped.
Nicknames are found using a dataset \citep{dbNickname} already used in \cite{structure_clustering}.
In some cases the first name, the diminutive, or the nickname has been labeled as a last name in other names, those names are also added.
For each pair of names from this group that have compatible genders, the names are linked
\begin{itemize}
\item
using a primary link if:
\begin{itemize}
\item they have the same last name and their first name is the original first name, a diminutive or a related nickname.
This also works with pair of nouns that don't have an extracted last name. For instance: ``D Dursley'' and ``Dudley Dursley''.
\item if both of the names have an empty last name or first name.
In this case, the algorithm considers that they share the same first name/last name even if it is possibly labeled differently in each name.
For instance:``Mr Flitwick'' and ``Professor Flitwick''.
\end{itemize}
Once 2 names are connected with a primary link, if one of them was neutral, he will receive the gender of the other word.
\item
using a secondary link if:
\begin{itemize}
\item their first name is the original first name, a diminutive or a related nickname and only one of them have an empty last name.
\item if one of them has an empty first name.
\end{itemize}
Secondary links represent a potential connection between names that could be unrelated.
For instance ''Mr. Durlsey'' could be related to ``Dudley Dursley'' or to ``Vernon Dursley'', so he will be linked using a secondary link to both of them.
``Harry Potter'' and ``James Potter'' should not be linked as it appears clear that they are 2 different characters with a common last name.
\end{itemize}

In a second phase, all last names are taken one by one.
Last names that have also been used in the previous pass as a first name are not considered because they are likely to be incorrectly labeled.
All names sharing the last name or a diminutive are grouped. For each pair in this group, if they have compatible genders, they are linked using:
\begin{itemize}
\item a primary link if both of their first names are empty.
\item an in primary link in other cases.
\end{itemize}

In the next pass, we will observe secondary links and distinguish those that are due to a true connection and those that should be removed.
We will take the names that contain less information and try to link them with the names that are more likely to be their neighbors.
The chosen neighbor is the most common name among the neighbors. This technique will result in some errors but their numbers should be limited.
Before going to the first pass, all secondary links between names of the opposite gender are removed. Some links with such property may appear after the 2 first pass.\\

The third pass focuses on neutral names of category 1 and 2. We will try to find them a gendered alias among their potential partners.
Firstly each of them will be grouped with all names connected to the neutral name using primary links. Then a second group will be formed with all its secondary-neighbors.
Iteratively the most common neighbors will be removed from the second group and linked to the first group using a primary connection.
If the name is gendered, the gender will be assigned to all names from the first group and the process will end.
If the name is also neutral, all names primarily connected to it will be added to the first group and again the most common name from the second group will be chosen to be linked with the first group.\\

The fourth and fifth pass focus on names from the 3-4-5 categories that are not connected with names from the 1-2 categories.
Those names consist of a single first name or last name and should be linked to the most common character having this name.
Again in the fourth pass, they are grouped with the primarily-connected names.
The most common name among their secondary neighbors of 1-2 categories is added to the group and primarily linked with it.
But names that are not linked to any 1-2 names will remain unbound.
In the fifth pass, all secondary links between those unbound names will be iteratively transformed into a primary link.
Links between names that become incompatible due to their gender during the process are removed.\\

In the last part of the algorithm, clusters are made with names primary-connected, and the most common name of each cluster is chosen as head of the cluster.
The head of the clusters will be later used to designate a character in the social network.

\subsubsection{Performance}
\label{performance}
As explained in the state of the art, there is no straightforward way to measure the performance of the character extraction techniques.
Firstly the performance of the NER and the alias resolution system are not independent:
For instance, a NER method that adds redundant adjectives to names will only decrease the performance of the overall social network
if the alias resolution system is not able to link related names.
Secondly, most methods from the state of the art don't have open-access implementations.
Thirdly there is almost no annotated data that would allow to automatically score different methods.
The goal of the algorithm developed here is to find different aliases referring to each character.
But there exist multiple ways of doing it that are not strictly better than each other.
The name ``Weasley'' for instance could be associated accurately with multiple characters in the novel ``Harry Potter'' while associating it with the noun ``Malefoy'' is a mistake.\\

For those reasons, the method developed in this master thesis will only be compared with the previous method used in the software \citep{original} and with a method of the state of the art, \cite{character_meta}, as the authors provide the result of their character extraction for the novel ``Pride and Prejudice''. I will manually count the number of clusters headwords that refer to an actual character to count the number of false-positive of character detection. I will also compare the set of main characters detected by our program and the set of main characters detected by \cite{character_meta} and manually check which errors appear. This comparison is not possible with the original software as the program didn't classify the cluster of characters' names by the number of appearances.\\

To count the number of false characters, I've decided to consider only the most common name of a list of aliases.
So a character is considered false if the most common name is false even if other aliases are valid to designate a character.
The name should be part of the complete name of a character or designate it unambiguously. In the novel ``Harry Potter'' appears a lot of magic objects or animals.
They are considered as characters as they are potentially part of a conversation.
For instance, the word ``Hat'' (capitalized) is considered as designating uniquely a character as it can only refer to a speaking object ``the Magic Hat''
but the words ``Mommy'' or ``Chaser'' could refer to a lot of characters according to context,
they are considered as an error. Word related to name, like ``Potter'' is still considered valid even if they are not unique.
This measure doesn't indicate how well aliases are bound by the algorithm but it allows to measure
if the algorithm can isolate names referring to a character in the text. \\

\begin{table}
\center
\caption{Number of detected character that refers to actual characters(true positive).}\label{tab1}
\scalebox{1}{%
\begin{tabular}{|c|c|c|c|}
\hline
book & Proposed method & \cite{original} & \cite{character_meta}\\
\hline
Harry Potter 1& 65\% (70/108) & 32\% (61/193) & // \\
The Lunar Cycle & 67\% (24/36)& 26\% (25/96)& // \\
Pride and prejudice & 89\% (44/56) & 46\% (53/116) & 85\%(61/72 ) \\
\hline
\end{tabular}}

\end{table}

The result shows that the proposed algorithm is far better than \cite{original} at the task of recognizing characters entities in a
novel, for the 3 tested novels, the rate of ``true characters'' is each time at least two times bigger. We also see that the result variate
a lot from one novel to another.
This could be explained by the fact that some novels as ``Harry Potter'' develop a large universe and invent a lot of proper names to describe it.
Those unknown proper words are particularly difficult for the extractor to deal with. A program using more syntactic information could decrease the importance of this issue.
The presented algorithm obtain result very near from \cite{character_meta} however the type of errors that appears on the novel `'Pride and Prejudice'' differs.
In \cite{character_meta} most of the errors comes from anaphoric noun phrase such as \textit{servant}, \textit{housekeeper}, \textit{owner} or \textit{assistant}.
In our program, those elements should not be extracted as they are not uniquely linked to a character and depend on their context but we could imagine that another program that constructs a social network in a context-dependent way could use that information.
Most of the errors that appears in our own program are names of location wrongly considered as character: \textit{Netherfield Park}, \textit{Pemberley House}, \textit{Brighton}, \textit{North}.
This difference of topologies between errors of the 2 considered method could be since
we develop our own ``Name Entity Recognition'' program adapted to characters recognition that is mainly focused on the form of words which allows separating anaphoric noun phrase
from proper names but can not use syntactic information to separate names of characters from uncommon locations.
The ``location'' tag of the TAG-Poser is used as a list of countries but it only allows to detect of the most common location.
On the other hand, \cite{structure_clustering} is using a Named Entity Recognition tool that should be able to label names as person or location.
For future works, it would be interesting to combine rules used by this method with a standard NER tool that would separate characters' names from locations. \\

The second test that we will make here will be to compare the main clusters of names that represent the characters for the presented method and \cite{character_meta}.
This test has the disadvantage of being manual and qualitative rather than automated and quantitative.
But no metric exists to measure the ability of an alias resolution system to connect the related names between them.\\

\begin{table}[]
\scalebox{0.65}{%
\begin{tabular}{|l|l|l|l|}
\hline
False Positive &
Appearance &
Gender &
Aliases \\
\hline
0 &
920 &
-1 &
'Elizabeth, Lizzy, Eliza, Miss Elizabeth, Miss Elizabeth Bennet, Bennets, Mrs. Bennet, Mrs. Bennet\\
& & &'--My Miss Bennets, Miss Bennet, Elizabeth Bennet, Miss Eliza Bennet, All Elizabeth, Miss Eliza, Miss Lizzy \\
0 & 359 & 1 & 'Mr. Darcy, Mr. Darcy:--but, Mr. Darcy--that Mr. Darcy, ", Darcy \\
0 & 273 & -1 & 'Jane, Miss Jane Bennet \\
0 & 212 & 1 & 'Mr. Bingley, Bingley \\
0 & 188 & -1 & 'Lady Catherine, Kitty, Right Honourable Lady Catherine, Catherine \\
0 & 180 & 1 & 'Wickham, Mr. Wickham, Mr. Wickham--when, George Wickham, George \\
0 & 158 & -1 & 'Lydia, Miss Lydia Bennet, Miss Lydia, \\
0 & 148 & 1 & 'Mr. Collins, The Collinses, Collinses, \\
0 & 120 & -1 & 'Charlotte, Lady Lucas, Miss Lucas, Miss Lucases, Charlotte Lucas \\
1 &
114 &
1 &
'Netherfield, Netherfield Park, Rosings Park, Park, Rosings, The Netherfield\\
0 & 106 & -1 & 'Miss Bingley, Mrs. Bingley, Caroline Bingley,Bingleys, Caroline \\
0 & 94 & -1 & 'Longbourn, Mrs. Long, Long,The Longbourn \\
0 & 86 & 1 & 'Mr. Bennet, The Bennets, Bennet \\
0 & 57 & -1 & 'Mrs. Gardiner \\
0 & 56 & 1 & 'Sir William, Sir William Lucas, Lucas,Lucases, The Lucases\\
0 & 56 & -1 & 'Mary, Maria, Maria Lucas, \\
1 & 54 & 1 & 'Pemberley, Pemberley House, Longbourn House, \\
0 & 54 & -1 & 'Miss Darcy, Mrs. Darcy, Georgiana Darcy,Georgiana \\
0 & 53 & 0 & 'Meryton, All Meryton \\
0 & 40 & 1 & 'Mr. Gardiner, Gardiner, Gardiners, The Gardiners \\
\hline
\end{tabular}
}
\caption{20 main characters detected in ``Pride and Prejudice'' by the presented method.
The first column tells if the character refers to a true character from the novel. It was used in the second measurement.
The second column contains the total number of appearances of names related to the character and the third one contains a 1 if the inferred gender is male,
a 0 if it is neutral and a -1 if it is female. The last column contains all aliases of the character. }

\scalebox{0.7}{
\begin{tabular}{|l|l|l|}
\hline
False positive & Appearance & Aliases \\
\hline
0 & 752 & Eliza, Elizabeth, Lizzy, Miss Eliza, Miss Eliza Bennet, Miss Elizabeth, Miss Elizabeth Bennet, Miss Lizzy \\
0 & 313 & Bennet, Mr. Bennet \\
0 & 309 & Colonel Fitzwilliam, Fitzwilliam, Mr. Darcy, Mr. Fitzwilliam Darcy \\
0 & 291 & Jane, Miss Jane Bennet \\
0 & 217 & Catherine, Honourable Lady Catherine, Kitty, Lady Catherine, Lady Catherine de Bourgh, Miss de Bourgh\\
0 & 150 & Mr. Collins \\
0 & 115 & Mr. Bingley \\
0 & 107 & Lady Lucas, Maria, Maria Lucas, Mary, Mary King, Miss King, Miss Lucas \\
0 & 73 & Mr. Wickham \\
0 & 58 & Mrs. Gardiner \\
0 & 45 & Sir William, Sir William Lucas, William Goulding \\
0 & 39 & Colonel Forster, Forster \\
0 & 36 & Gardiner, Mr. Gardiner \\
0 & 34 & Lydia \\
0 & 29 & Mrs. Collins \\
0 & 21 & Mrs. Hurst \\
0 & 20 & Mrs. Phillips \\
1 & 18 & servant \\
0 & 16 & Caroline \\
1 & 16 & housekeeper \\
\hline
\end{tabular}}
\caption{20 main characters detected in ``Pride and Prejudice'' by \cite{character_meta}.
The first column tells if the character refers to a true character from the novel. It was used in the second measurement.
The second column contains the total number of appearances of names related to the character. The last column contains all aliases of the character. }

\end{table}

In the character extraction of Pride and Prejudice, the first difficulty that appears is the extraction of the Bennet family.
In this family, there are 5 daughters named in the text and a mother only referred to as Mrs. Bennet.
In the presented method, the character of Mrs. Bennet has been mixed with ``Elizabeth Bennet'', the most common character among the sisters. About that last character,
both methods have been able to link it with her nicknames ``Eliza'' and ``Lizzy''. In the Bennet family, both methods isolate correctly the sisters ``Jane''' and ``Lydia''
but \cite{character_meta} didn't record the alias ``Lydia Bennet''.
Our method has a second error, the character `` Mr. Fitzwilliam Darcy `` is separated into 2 characters: ``Mr. Darcy'' and ``Mr. Fitzwilliam'' that doesn't appear on the figure
as it is less used. But the character ``Charlotte Lucas'' is correctly extracted while \cite{character_meta} mix it with another character `Mary King'.
They also mix the character ``William Goulding'' with the character ``William Lucas''.
We see that they have considered 2 anaphoric noun phrase as character: ``servant'' and ``housekeeper''
while our method has wrongly considered 2 locations as character ``Pemberley House'' and ``Netherfield Park''.
Our method binds family names such as ``'The Gardiners'' with the most common characters of the family while the other method avoids using them.\\

The observation of the characters extracted by both methods shows some tendencies. Our method tends to extract more aliases but also extract some incorrect ones.
It also binds sets of aliases more cautiously with result in dividing a character into two sets of aliases but avoid to mix between them completely different characters.
The only case of mixed characters in our method comes from characters of the same family that differs only by a title, both associated with the same gender.
As previously shown, the proposed method ignore anaphoric noun phrase but is likely to consider locations as characters.
This analysis doesn't allow us to consider one of the methods to be better than the other.
From this, we can consider that our method result is approximately equivalent to the state of the art. \\

A major default that should be pointed of the proposed method is the use of a word dataset for honorific detection.
Honorifics are only properly labeled if they are present in the word list. Therefore, novels using a set of foreign honorifics or inventing their own set of honorifics
(which is common in fantasy or science fiction) could completely miss them.
Honorifics would be considered as first names and it could decrease the performance of the alias-resolution process.
Also, characters would be less likely to be gendered. \\


Results for character extraction of other novels are available on appendix \ref{alias_extracted}. \\

\subsubsection{Further improvement}
The method developed here for character extraction in novels gives satisfying results but could have several improvements.
Firstly a NER tool should be used in order to use syntactical information to separate location from characters names.
Secondly, some rules could be added to link aliases between them for instance in the case of characters having multiple last names.
Contextual information could be used in order to link the appearances proper names of category 3-4-5 to different characters.
For instance appearances of ``Mr. Potter'' could be bound to ``Harry Potter'' or ``James Potter'' following contextual information.
Thirdly a way of using anaphoric noun phrase in the system could be used in order to detect unnamed characters
but this addition should be handle carefully as the addition of anaphoric noun phrase could lead to the extraction of many names that are not linked to a character
in an unambiguous way.
Then to label the gender of names, pronouns of the contexts could be used.
It would also be useful to extend the set of recognized honorifics or to implement a way to detect new honorifics in a novel.\\

\begin{table}
\center
\scalebox{0.7}{%
\begin{tabular}{|c|c|}
\hline
Speaker & Issue\\
\hline
_BEAUREGARD - KLAN NARRATOR (O.S.) & The name is given with an anaphora  \\
_JEROME TURNER (V.O.)(CONT'D)& additional information are given with the annotation \\
_RON (CONT'D) / _RON STALLWORTH& This is 2 different annotation that refers to the same character\\
_RON STALLWORTH, FLIP AND JIMMY& An annotation can refer to multiple character\\
_CSPD OFFICER BRICKHOUSE & Character can be represented by their function and not only by their name\\
_AMERICAN TERRORISTS & Groups are also considered as speaker in some situation\\
\hline
\end{tabular}}
\caption{Speaker annotated in the script of the movie Blackkklansman}\label{annotation}
\end{table}

\subsection{Character extraction in scripts}
As previously explained, in all scripts, the speaker is directly annotated for most of the dialogs.
The list of annotated speakers is a good approximation of the character list. However, it causes a list of issues that I will detail hereunder.
Example annotations are given on table \ref{annotation} to illustrate issues caused by using those annotations.\\

\begin{itemize}
\item
The observation of scripts shows that those annotations mostly use canonical characters' names (with the first and last name for the character).
But sometimes characters are only referred with their first or last name. So a minimal alias resolution system is needed.
\item
As the name of characters used for annotation is mostly canonical names, the list will miss aliases of the characters.
Especially nicknames and familiar names used by characters that are very intimate with each other.
\item If a character doesn't talk during a conversation and is only mentioned by other characters using unknown aliases,
he will not be detected as taking part in the conversation. The network may miss some relations.
\item
If a character is part of the audience in some conversation but never talk, he will not be added to the social network. We may lose some minor characters.
\item Information could be difficult to extract from annotations.
Multiple characters or extra information could be written and everything is uppercase which makes it difficult to extract names. A system filtering the information is needed.
\item As scripts are not perfectly formatted, the automatic labeling of speaker and dialogs using regex may lead to errors.
I've corrected some of those but I can't manually fix them all. This causes the incorrect extractions of words as characters.
\end{itemize}

In order to use annotations while diminishing the number of related errors, a method has been developed.
The method is inspired by the previous method for novels with many simplifications. The method is developed hereunder:
\begin{enumerate}
\item In pre-processing: When a parenthesis is detected, we assume that the end of the sentence is an additional annotation that we don't keep. All words are capitalized. The sentence is spitted in multiple speakers when ``And'', ``/'' or ``,`` are detected. Useless characters such as ``;'' or ``.'' are removed.
\item At the beginning of character extraction, all speakers are registered as proper names.
\item Each of the proper names that composed the speakers are also registered as proper names and linked with the corresponding speaker using a secondary link.
\item Speakers are also split when a ``-'' is detected. ``-'' are used in scripts to gives multiple names to the same speaker, for instance: ``_BEAUREGARD - KLAN NARRATOR ``.
All names generated from the split are considered as proper names and linked with the corresponding speaker using a primary link.
\item The genders of all names are inferred using the technique explained in section \ref{section:classification}.
\item For all extracted names that have been at least one time extracted after a split (they have been part of a bigger speaker in one occurrence), the neighbor who has the most appearances is chosen. If the neighbor has a compatible gender, he is linked with a primary linked and their gender is equalized following the technique of section \ref{section:alias}.
\item Clusters are made of names connected by primary links. The name with the most appearances is the head of the cluster. Each cluster represents a character and its aliases.
\end{enumerate}


\begin{table}[]
\scalebox{0.75}{%
\csvautotabular[separator=semicolon]{csv/bkk_scriptStyle.csv}
}
\caption{Extracted characters of the script of the movie Blackkklansman with the algorithm designed for scripts.
There is a 1 in the first column if the headword is not designating a character in an unambiguous way.
The second column contains the total number of times each alias of the character has been recorded as a speaker.
The third one contains the gender of the character. Then comes all aliases of the name. The rate of true positive is $0.823529412$.}
\label{character_bkm}
\end{table}

\begin{table}[]
\scalebox{0.50}{%
\csvautotabular[separator=semicolon]{csv/bkk_novelStyle.csv}
}
\caption{Extracted characters of the script of the movie Blackkklansman with the algorithm designed for novels.
There is a 1 in the first column if the headword is not designating a character in an unambiguous way.
The second column contains the total number of times each alias of the character has been recorded as a speaker.
The third one contains the gender of the character. Then comes all aliases of the name. The rate of true positive is $0.251655629$.}
\label{bkk_nov}
\end{table}

The method allows increasing the number of detected aliases, linking aliases between them, and inferring gender from names.
It also allows to filter useless information from speakers and split multiple speakers when they appear.
As speakers are not always properly chosen in pre-processing, we may still have some errors.
There is also still the problem with the non-speaking character. However, those characters are minor and we consider that it is not an important issue.
In the movie ``Blackkklansman'', no errors are detected. All the extracted characters are really speakers from the story and their aliases are correctly bound.
However some of the speakers are not a human being: ``Pre - Recorded Message'' refers to a sentence given by the messaging system of a phone,
``All'' refers to a sentence said by a crowd. I remind that in section \ref{performance}, I've defined speaking objects as potential characters.
The list of extracted characters of ``blackklansman'' is given on figure \ref{character_bkm}.\\

\subsubsection{Result of the character extraction in scripts}
Characters have been extracted from the script of Blackkklansman using the algorithm designed for scripts and the one designed for novels.
Result are shown on figure \ref{character_bkm} and \ref{bkk_nov}. The rate of true positive is respectively $0.82$ and $0.25$.
The result provided by the algorithm fitted for scripts is comparable to the result that we obtained with novels.
It seems even higher but we would need to annotate a huge dataset of texts to be sure about it, which would be very time-consuming.
We see that the algorithm proposed for novels provides worse results with scripts. Using it on script leads to more errors as scripts have a less regular format than novels.
This difference could be explained by the fact that scripts are not commercial products, they are not salable so errors in the format are not corrected while the script is understandable for the users.
In particular, we found more uppercase words that make the extractions of proper names more difficult.
However, the use of techniques associated with novels on scripts could improve the result for further advancement when the character extractor will increase the precision,
as techniques associated with novels use more information than just the annotation. Results for character extraction of other scripts are available on appendix \ref{alias_extracted}.\\


\subsection{Identification of character appearances}
\label{identification}
This step consists of binding each occurrence of character mention to the corresponding character and identifying speakers and listeners in each dialog.
The algorithm has been mainly designed by \cite{original_thesis} but some adaptations have been made.
The previous algorithm was using proper nouns and chunks associated with them.
The new version uses all proper names.\\

\subsubsection{Detection of potential speakers and listeners}
The first phase of this task is the identification of potential speakers and listeners in dialogs. This doesn't require the use of the character list previously extracted. It can also be considered as a part of the conversation construction.\\

The program already parsed all sentences and separated dialogs from context. The parsing includes the tagging of words by a POS-tagger.
All groups of words labeled as a subject by the POS-tagger are considered potential speakers. Words labeled as objects of the sentence are potential listeners.
Those groups of words are mainly pronouns and anaphoric nouns phrase, which are useless for the social network construction.
Proper names will be extracted from those groups of words. If no proper name can be extracted, the subject or object is not kept.

\subsubsection{Filtering of potential speaker and listener}
\label{filtering}
For each conversation, each character detected as a speaker or listener needs to be associated with a character extracted in the text.
I remind that potential speakers and listeners are proper names. To look for a character, the following step are followed:\\
\begin{enumerate}
\item If the name corresponds to an alias, they are linked.
\item If it is not directly related to an alias, the name is separated into its different names. We link the name with each alias that corresponds to one of those names.
\item At the end of the previous steps, the name is linked with 0, 1, or multiple aliases. The characters corresponding to each alias will be looked up
and we consider that each of them made an appearance in this sentence.
\end{enumerate}

\subsubsection{Identification of characters in conversations}
The program loads separately each conversation and looks for characters' appearance into it. Characters are always separated into speaker and listener. \\
\begin{itemize}
\item Firstly all dialogs of the conversation are loaded and the program extracts characters from the potential speaker and listener and filters them using the procedure given in section \ref{filtering}.

\item If no speaker is found, the program will look for sentences of the context located around the dialog and try to extract names from it. In some situations the speaker is mentioned just before or after the dialog, such that in the following sentence of Harry Potter 1: “Oh, yes,” said Mr. Dursley, his heart sinking horribly. “Yes, I quite agree.”. In this sentence, the speaker, ``Mr. Dursley'', is mentioned just between the line of dialogs. If no speakers are found, the program will also look in the context associated with the previous and next dialogs.\\

\item After this step, the number of appearances of each speaker in the conversation is counted. If a dialog has multiple speakers, only the speaker that has the most appearance in the conversation is kept.

\item In the last step, if the speaker of some dialogs stays unknown, we will try to infer the speaker from data of other dialogs.
\begin{enumerate}
\item If there is only one speaker in the conversation, we assume this is a monologue and all dialogs are assigned to this speaker.
\item If there are 2 speakers, we assume that 2 characters are talking to each other. Firstly, the program will look for the speaker of the last dialog and assigned the other speaker to the dialog. If the conversation is beginning or the last dialog doesn't have an identified speaker, the program will look for the next dialog. Again, if a speaker is found, the other speaker is assigned to the dialog.
\item If there are more than 2 speakers, the program will look for the speakers of the previous and next dialogs. Then it will assign to the dialog the most common speaker from the conversation among all detected speakers except the speaker identified in the previous dialog.
\end{enumerate}
\item Again, the number of appearances of each speaker in the conversation is counted. If a dialog has multiple speakers, only the speaker that has the most appearance in the conversation is kept.

\item Each sentence of context is linked with the speaker of the nearest dialog.

\item If a dialog has no identified listener, the program consider that all characters appearing in the conversation are listener, except the speaker of the dialog.
\end{itemize}
This method has the disadvantage of giving more appearance to the most common speakers in a conversation. It also tends to add in conversation character that is mentioned without being part of it. For example, if in Harry Potter, Harry told to Ron ``Don't say that to Hermione'', she could wrongly be considered as the audience of the sentence. However, in such case, the social network that will use this information would still be meaningful, as Harry speaking about Hermione to Ron, implies a relationship between those 3 characters.


\subsubsection{Filtering of useless characters}
All characters that don't have been identified a single time among all conversations are removed from the list of characters. They will not be part of the social network.



\section{Construction of the network}
The social network is constructed using the identification of characters in dialogs in section \ref{identification}. The implementations is made using the python library \textit{networkx} \citep{networkx}.
Two types of network are constructed:
\begin{enumerate}
\item Context networks: social networks that are relative to a single conversation and the associated context.
\item Incremental networks: networks which are the result of the incremental addition of context networks. They represent the link between characters from a set of conversations.
\end{enumerate}
\subsection{Context networks}
Context networks are a particular type of network developed by \cite{original}. They have the particularity of representing only a conversation, so, all characters of those networks tend to be linked between them. They have been designed to make possible the construction of incremental networks. \\

They are built by executing the following steps:
\begin{enumerate}
\item A conversation and the related context are isolated.
\item For all dialogs having an identified speaker and audience, a link is added between the speaker and each of the members of the audience. The link is weighted following the number of dialogs that link a couple of characters. This weight initialized at 1. There is also a second weight representing the sentiment between the characters. It is initialized with the value of the polarity detected in the line of dialog.
\item If there is already a link between a speaker and a listener, the first weight is incremented. The polarity of the dialog is added to the sentiment-weight.
\item At the end of the network construction, the sentiment weight of each link is normalized by dividing it by the first weight of the link.
\end{enumerate}

\subsection{Incremental networks}
The name ``incremental network'' comes from \cite{original} in opposition to the context networks. They are constructed by incrementally adding context networks in chronological order. There are as many incremental networks as there are conversations in a novel or a script. The objective of constructing such graphs is to observe how the social network evolves with the story.
The final incremental networks represent all the relations in the narrative. It can be considered as a standard social network extracted from fiction that has been studied in many articles such as \cite{agarwal-etal-2013-automatic, NER, character_country, movie, fiction, Dekker2018EvaluatingSN}.\\

\begin{equation}
sentiment_{incremental}^{n+1} = \frac{weight - 1}{weight} \cdot Time-Factor * sentiment_{incremental}^{n} + sentiment_{context}\\
\label{sentiment}
\end{equation}

To build incremental networks, the context graphs are merged as follows: All-new nodes of the new context graph are added to the incremental networks.
All links are added by conserving the sentiment of the node and setting a weight at 1. This weight represents the number of conversations where the link appears and should not be confused with the weight of the context network. If a link was already existent in the incremental networks, the weight is increased by one.
The sentiment score is modified by using equation \ref{sentiment} with $Time-Factor = 1$.
The goal of this equation is to slightly decrease the importance of the previous sentiment score and see how the sentiment between characters evolves during the narrative.
At the end of the addition of links, all nodes that represent characters that don't appear in enough conversation are removed. The goal of this removal is to throw all false characters and minor characters that are not important for the social network. The threshold value has been kept at 1 to keep minor characters as the new character extraction system has already removed a lot of false characters.\\

\subsection{Final incremental networks}

\begin{figure}
\centering
\includegraphics[width=\linewidth]{pictures/_final_graph/Harry_Potter_1.png}
\caption{Final Incremental Network of the novel Harry Potter 1.}
\label{sn_harry}
\end{figure}

The final incremental networks of all texts are available in appendix \ref{final_sn}. A first example is shown on figure \ref{sn_harry}.\\
The networks have been drawn using the following rules:
\begin{itemize}
\item The size of each node is proportional to its degree.
\item The color of each node is given by its labeled gender: blue for male characters, green for neutral characters, and red for female characters.
\item Edges colors are given by the sentiment between 2 characters.
\item Edge size is given by the weight of the edge which represents the number of conversations 2 characters participate in.
\item Networks are drawn using Kamada–Kawai algorithm.
\end{itemize}

\newpage
\section{Data-extracted}
Various data have been extracted from the document during the building of the network and can be used for further analysis. This data includes networks, information about the characters, and dialogs or meta-data used by the program.
Extracted networks includes:
\begin{itemize}
\item The global network under the form of a \textit{.gefx} and \textit{.json} file. Those format make possible to manipulate the graph using external software like Gephi.
\item A \textit{.png} representation of each context and incremental graphs. Final incremental graphs are available on appendix \ref{final_sn}.
\item A csv file with the edges, weight and sentiment of all incremental and context graph produced.
\end{itemize}

The other data produced by the program are CSV files containing:
\begin{itemize}
\item the extracted speaker and audience of each dialog of the text with the perceived sentiment and the index of the conversation.
\item all aliases associated with each character, the number of appearances of all those aliases, and the inferred gender.
\item all the proper names extracted with their inferred gender, categories, and the number of appearances.
\item all primary and secondary links between names used for alias co-resolution.
\item the spacing between each pair of consecutive dialogs, the frequency of each spacing value, and the final threshold value used to delimit conversations.
\item the index of the beginning and the end of each conversation.
\end{itemize}








\chapter{Network analysis}
In this second chapter, the final incremental social networks are analyzed. In this section, we will refer to them as the ``extracted networks''.
We will compare them with networks of equivalent size generated using different mechanisms, they are referred to as the ``generated networks''.
Some analyses have been produced by \cite{original} and will be actualized using the correction of the network extraction process.
The analysis will also benefit from the addition of new metrics, the comparison between novels and scripts, and the addition of gender in the network.

\section{Connectivity}

\begin{table}[]
\scalebox{0.53}{%
\csvautotabular[separator=semicolon]{csv/signatures.csv}
}
\caption{Data collected for each novel and script. Some titles are under the form of an abbreviation, the corresponding title
is in the appendix. The title of movies scripts ends with the mention \textit{SCRIPT}.}
\label{signature}
\end{table}

The size of each component of novels and scripts is on table \ref{signature}. The number of components changes a lot between the texts. In all cases, there is a big one that groups most characters, sometimes all of them. The size of the smaller components is often 1 or 2. The bigger secondary component is located in TLT\_1 and has a size of 6 while the main component has a size of 106. So the social network is composed of the main set of connected characters while some characters are isolated or connected in small groups. Some of the isolated characters are due to errors in character detection while others are due to dialog between minor characters or monologue of characters appearing in one scene only. From this, we consider that the main component of a network is sufficient to observe the topology of the network. In the next sections when only connected networks can be considered, the main component will be used. For instance, the mean path length can only be computed on a connected network.


\section{Measures}
Multiple measures have been performed on social networks: mean path length, mean degree, and clustering coefficients (transitivity and global clustering coefficients). For each graph, a small-world network, a random network, and a scale-free network have been generated with approximately the same number of nodes and edges as the extracted networks. Measures have also been performed on those graphs in order to allow comparison between different types of networks and make easier the classification of characters social network. The generated networks don't have exactly the same number of edges and nodes as the original ones. However, it's important to remember that those families of graphs are not distinct. Completes measures are available on appendix \ref{measures_generated}.\\

\begin{itemize}
\item Watts-Strogatz small-world networks are created using the method given in section \ref{sm-section}, with the same number of nodes as the original graph and with a probability of 0.5. Their mean degree is the nearest integer from the original mean degree.
\item Barabási-Albert scale-free networks are created following the method of section \ref{scale-free-section}. The $m$ value used is computed using the parameters of the original network:\\
$m = [NbrOfEdge / NbrOfNode]$. This gives a rough approximation of the number of edges of the original social network.
\item Random Erdös-Rényi networks are created using the method from section \ref{random-section}, with a number of edges following a random variable centered around the number of edges of the social network.
\item Lattice has not been generated as each type of lattice has approximately always the same values for clustering coefficient and mean degree. The mean path length of lattice growth with $\sqrt{N}$ for square lattices.
\end{itemize}

\subsection{Distribution of degree}
\cite{original} has shown that characters' social networks extracted from literature tend to have degree distribution following power-law. From this statement, the networks have been considered scale-free. The modifications in character extraction decrease a lot the number of characters so we should check that this observation hold.\\

\begin{figure}
\begin{subfigure}{.49\textwidth}
\centering
\includegraphics[width=\linewidth]{pictures/degree/ASOIAF_1}
\end{subfigure}
\hfill
\begin{subfigure}{.49\textwidth}
\centering
\includegraphics[width=\linewidth]{pictures/degree/Harry_Potter_1}
\end{subfigure}
\hfill
\begin{subfigure}{.49\textwidth}
\centering
\includegraphics[width=\linewidth]{pictures/degree/Pride_and_prejudice}
\end{subfigure}
\begin{subfigure}{.49\textwidth}
\centering
\includegraphics[width=\linewidth]{pictures/degree/TLC_1}
\end{subfigure}
\caption{Degree distribution of social networks extracted from the first novel of the series ``A song of ice and fire'', ``Harry Potter'', ``The Lunar Chronicles'' and from the novel ``Pride and prejudice''.}
\label{distrib_degree_4_novels}
\end{figure}

\begin{figure}
\begin{subfigure}{.49\textwidth}
\centering
\includegraphics[width=\linewidth]{pictures/degree/Alien_1_SCRIPT}
\end{subfigure}
\hfill
\begin{subfigure}{.49\textwidth}
\centering
\includegraphics[width=\linewidth]{pictures/degree/Harry_potter_1_SCRIPT}
\end{subfigure}
\hfill
\begin{subfigure}{.49\textwidth}
\centering
\includegraphics[width=\linewidth]{pictures/degree/pride_and_prejudice_SCRIPT}
\end{subfigure}
\begin{subfigure}{.49\textwidth}
\centering
\includegraphics[width=\linewidth]{pictures/degree/Thor_Ragnarok_SCRIPT}
\end{subfigure}
\caption{Degree distribution of social networks extracted from the script of the first movie of the saga``Harry Potter'', ``Alien'' and from the movies ``Pride and prejudice'', ``Thor: Ragnarok''. All degree distribution are available on appendix \ref{a_degree}.}
\label{distrib_degree_4_scripts}
\end{figure}

In figure \ref{distrib_degree_4_novels}, the degree distributions from 4 novels show a big amount of nodes with small degrees and fewer nodes with more degrees. The first graph looks like a heavy-tail distribution but others seem to have a more flattened curve. Also, we see that the graphs have many irregularities. Because of this, I have added all the distributions extracted from novels in a single distribution to fit it. It was already the way used by \cite{original}.
The distributions extracted from 4 movies are also shown on figure \ref{distrib_degree_4_scripts}. The first example shows a distribution completely different from the others networks, this is due to the fact that the movie is a ``huis-clos'': all the narratives happen in a close environment with a limited amount of characters. In such a movie, it's intuitive that most characters are linked, this should also happen to books following this principle. However no books from our collections present this specificity, we can not verify it. The other hypothesis is that movies are more likely to present configurations with a smaller number of characters as this limits the cost of production. Other books present a decreasing graph like novels but it seems polynomial. Like novels, the degree distribution has been summed in order to observe their general behavior. \\

\begin{figure}
\begin{subfigure}{\textwidth}
\centering
\includegraphics[width=0.45\linewidth]{pictures/degree_novels}
\end{subfigure}
\\
\begin{subfigure}{.45\textwidth}
\centering
\includegraphics[width=\linewidth]{pictures/degree_novels2}
\end{subfigure}
\hfill
\begin{subfigure}{.45\textwidth}
\centering
\includegraphics[width=\linewidth]{pictures/degree_script}
\end{subfigure}
\hfill
\begin{subfigure}{.45\textwidth}
\centering
\includegraphics[width=\linewidth]{pictures/degree_novels_semi_log}
\end{subfigure}
\hfill
\begin{subfigure}{.45\textwidth}
\centering
\includegraphics[width=\linewidth]{pictures/degree_script_semi_log}
\end{subfigure}
\hfill
\begin{subfigure}{.45\textwidth}
\centering
\includegraphics[width=\linewidth]{pictures/degree_novels_log}
\end{subfigure}
\hfill
\begin{subfigure}{.45\textwidth}
\centering
\includegraphics[width=\linewidth]{pictures/degree_script_log}
\end{subfigure}
\caption{Mean degree distribution of all novels (left) and scripts (right) on linear, log scale and log-log scale. The first image takes the linear view on novels with a wider scale. For the novels, the power-law fit has for equation $f(x) = 147.23761823 \cdot x^{-1.59962459}$ and the exponential fit has for equation $f(x) = 25.13373576 \cdot -0.15795688^x$. For the scripts, the power-law fit has for equation $f(x) = 14.05704682 \cdot x^{-0.96477256}$ and the exponential fit has for equation $f(x) = 5.51683625 \cdot -0.11227941^x$.}
\label{cumulated_degree_novel}
\end{figure}


The figure \ref{cumulated_degree_novel} shows the mean distribution on all novels and scripts with an exponential fit and a power-law fit. For the novels, the power-law distribution seems to be the best approximation of the degree distribution. On the second sub-figure which is a zoom on the left of the graph, we can see that the exponential fit doesn't grow as fast as the distribution while the power-law fit has an equivalent growth. On the log-log scale, the curve seems linear like a power-law distribution for small values of x. From this, we can conclude that the degree distribution of novels follows a power-law like scale-free networks. The parameter of this power-law is -1.59962459.
The degree distributions of the script have not the same shape. On the first figure, it's difficult to say whether the exponential or power-law distribution is the best approximation. However, in the next figures, we see that the distribution is more linear on a log scale than on a log-log scale. The exponential seems to be the best approximation but is not a perfect fit. The distribution is maybe composed of an exponential and a power-law. It's a major difference between novels and script. In section \ref{scale-free-section}, we saw that ``hard'' criteria of scale-free networks include having a k parameters between 2 and 3. Script are not satisfying this condition, unlike novels.\\

\subsection{Clustering coefficient}


\begin{table}[]
\scalebox{0.5}{%
\begin{tabular}{|l|l|l|l|l|l|l | l| l| l|}
\hline
&\multicolumn{2}{|c|}{Erdos Random Networks} & \multicolumn{2}{|c|}{Barabasi-Albert Scale-Free Networks} & \multicolumn{2}{|c|}{Watts-Strogatz Small-World Networks} & \multicolumn{2}{|c|}{Social Network} \\
\hline
&Clustering Coefficient & Transitivity & Clustering Coefficient & Transitivity & Clustering Coefficient & Transitivity & Clustering Coefficient & Transitivity \\
\hline
Standard Deviation of all texts & 0.103438428 &	0.105189808	&0.086314581&	0.083681264&	0.05950426&	0.06339274&	0.112109747&	0.156089578\\
Mean	of all texts &0.108824103&	0.108335676&	0.184424947&	0.135853174&	0.351994698&	0.335964053	&0.55634396&	0.321284016\\
\hline
Standard Deviation of all novels &0.049903329&	0.047621076&	0.053997042&	0.0478291&	0.03102255&	0.0326821&	0.052620495&	0.104985274\\
Mean	of all novels & 0.060090885&	0.059953799&	0.14185425&	0.095554636&	0.3363694&	0.320140702&	0.494909494&	0.24748642\\
\hline
Standard Deviation of all scripts &0.115688058&	0.121983066&	0.086152797&	0.087509623&	0.101517005&	0.104581786&	0.147973772&	0.15368119\\
Mean	of all scripts & 0.191651597&	0.190647547&	0.253319084&	0.20257765&	0.367782598&	0.352827121&	0.644556967&	0.440894941\\
\hline

\end{tabular}}
\caption{Mean and standard deviation of mean global clustering coefficient and transitivity for extracted social networks and generated networks on novels and scripts.}
\label{clustering_coeff_average}
\end{table}


The first thing to notice on the values pf table \ref{signature} is that the transitivity is lower than the average clustering for almost all graphs. This result is due to the fact that transitivity gives more weight to nodes with higher degrees, those nodes being evolved in more potential triangles. In our social network, the main characters are linked with multiple sets of connected characters. For this reason, main characters tend to have a lower clustering coefficient. For instance in ``Harry potter'', Harry is connected to all members of the Dursley family and to most of the Hogwarts students. The only network that presents high transitivity is the first movie of the saga Alien which story present only 6 main characters and almost no minor characters. Table \ref{clustering_coeff_average} shows that the mean values of the global clustering coefficients are bigger on the extracted social networks than for any family of generated networks. This is true for both scripts and novels, however, novels have lower coefficients than scripts. This can be explained by the fact that movies tend to introduce fewer secondary characters as their script are shorter than novels. We should also consider a bias in character extraction: in movies, we are only extracting character that has have been annotated as a speaker which erases some extra roles. Very big clustering coefficients are a property shared by networks as lattices and small-world networks. \\


\subsection{Mean path length}
\begin{figure}
\begin{subfigure}{.49\textwidth}
\centering
\includegraphics[width=\linewidth]{pictures/mean_path}
\end{subfigure}
\hfill
\begin{subfigure}{.49\textwidth}
\centering
\includegraphics[width=\linewidth]{pictures/mean_path_log}
\end{subfigure}
\hfill
\begin{subfigure}{.49\textwidth}
\centering
\includegraphics[width=\linewidth]{pictures/path_novels_log_semi}
\end{subfigure}
\hfill
\begin{subfigure}{.49\textwidth}
\centering
\includegraphics[width=\linewidth]{pictures/path_script_semi_log}
\end{subfigure}
\caption{Mean shortest path following the graph size. The 2 first images presents the values for all the texts. The last one present only values from novels or script with a logarithmic fitting. }
\label{mean_path}
\end{figure}


\begin{table}[]
\scalebox{0.5}{%
\begin{tabular}{|l|l|l|l|l|l|}
\hline
&Erdos Random Networks & Barabasi-Albert Scale-Free Networks & Watts-Strogatz Small-World Networks & Social Network \\
\hline
Standard Deviation of all texts & 0.497325878&	0.360324271&	0.764052807&	0.269248092\\
Mean of all texts &2.558330812	&2.433149983	&3.070594256&	2.242487429\\
\hline
Standard Deviation of all novels &0.398109091&	0.280303615	&0.632982852&	0.17254051\\
Mean	of all novels & 2.778345124&	2.603138839&	3.374638372&	2.368047787\\
\hline
Standard Deviation of all scripts &0.409088171&	0.280991354&	0.674406656	&0.266162628\\
Mean	of all scripts &2.169074722&	2.132400468	&2.532670051&	2.02034218\\
\hline

\end{tabular}}
\caption{Mean and standard deviation of mean global clustering coefficient and transitivity for extracted social networks and generated networks on novels and scripts.}
\label{path_length_values}
\end{table}

As some graphs have multiple components, the mean path has been computed on the bigger ones. Result are on table \ref{signature}. This should be a meaningful measure as graphs are usually composed of a big component and few very little ones whose lengths are near from 1. The first thing to notice is that the mean path length is very small for all stories and doesn't vary a lot. The bigger values are under 3 and the smaller ones around 1.6. There is an exception for ``Alien 1'' which has a mean path length of 1.25. It confirms the intuition that stories with very few characters such as ``huis-clos'' tend to have more clustered networks.
The distribution of mean path following graph size is given in figure \ref{mean_path}.
For small network size, it seems to follow a logarithmic law, this evolution is characteristic of small-world networks. However, the data is very sparse and we can not be sure that it's not satisfying the ``ultra small-world property'' of scale-free networks. More data are needed in order to approximate this curve with precision.
For bigger graph sizes, the mean path seems to become more constant. This particularity might be explained by the nature of social networks extracted from stories: most small-world networks are scalable.
Very small portions of their nodes are hubs but the number of hubs increases with the growth of the network. Most non-hubs nodes are directly linked to hubs but some shortest paths may need to pass on multiple hubs.
In the case of social networks extracted from stories, hubs represent the main characters.
Even if the stories become bigger and more secondary characters are encountered, the number of main characters will tend to be bounded, especially in movies.
An exception to this is found in the series `A Song of Ice and Fire'' and ``The Wheel of Time'' that evoke multiple plots with different sets of main characters in a single book.
On table \ref{path_length_values}, we see that for both scripts and movies the social networks tends to have smaller mean path length than generated networks. Script have smaller value but the network generated by the scripts also have smaller values. It shows that the number of edges and nodes of scripts is more likely to generate a smaller mean path length. Table \ref{mean_path} was also showing that smaller stories tend to have smaller mean path length.

\subsection{Preferential attachment}

\begin{figure}
\begin{subfigure}{.49\textwidth}
\centering
\includegraphics[width=\linewidth]{pictures/attachement/Harry_potter_1_SCRIPT}
\end{subfigure}
\hfill
\begin{subfigure}{.49\textwidth}
\centering
\includegraphics[width=\linewidth]{pictures/attachement/Harry_potter_1}
\end{subfigure}
\hfill
\begin{subfigure}{.49\textwidth}
\centering
\includegraphics[width=\linewidth]{pictures/attachement/Blackkklansman_SCRIPT}
\end{subfigure}
\hfill
\begin{subfigure}{.49\textwidth}
\includegraphics[width=\linewidth]{pictures/attachement/ASOIAF_1}
\end{subfigure}
\caption{Probability of attachment to a node following the final degree of the node with a linear fitting for 2 scripts and novels : Harry Potter (novels and script), Blackkklansman and A Song Of Ice and Fire (from which Games of Thrones has been adapted
).}
\label{attachement}
\end{figure}

To measure the preferential attachment, the probability of attachment to a node has been plotted following the node degree. There is various way of doing it. In this work, the probability of attachment to a node \textit{n} corresponds to the probability for a new node to be linked to \textit{n} when the new node is added to the incremental network. The degree taken is the final degree of the second node at the end of the graph construction. It would also be possible to use the degree value at the moment of the addition of the new node. But this method would mix values observed for a node with degree X at the start of the story and the values observed for the second node of degree X at the end of the story despite the fact that the importance of the X-degree node change along with the story (some degrees values are initially shared by main characters but become a value related to secondary characters at the end of the story). \\

The result is given in figure \ref{attachement} for 2 novels and scripts. Other attachment plots are available on appendix \ref{ref_attachement}. For most extracted social networks the probability of attachment to a node evolve linearly with the final degree of this node. From this, we can observe that both scripts and movie tends to increase their social network with a mechanism of preferential attachment. This is quite intuitive as new characters are more likely to interact with new characters. This property is a characteristic of scale-free networks.


\section{Gender distribution}
During the network construction, gender has been assigned to characters in order to simplify the alias resolution process.
For reasons of simplification, the hypothesis has been done that all characters should have a male or female gender.
During the process, names that could not be labeled have kept a neutral label that could also be called a ``unknown'' label.
It doesn't mean that the program considers them as gender-neutral persons.
These neutral characters groups secondary characters that have not been called
by a nickname or an honorific and characters that have been called with a nickname or an honorific unknown from the dataset.\\

In this section, we will observe the distribution of gender in novels and script while keeping in mind that the extracted networks do not form a perfect dataset:
the gender of some characters might have been incorrectly labeled and a lot of characters didn't receive a gender at all.
Some bias may exist in the dataset of first name and honorific that would favor the labeling of male or female characters.
In novels, characters have been extracted from all the text while in movie characters have only been taken from annotations :
networks extracted from novels should assign a gender to more main characters than networks from scripts, as there are more aliases available to extract a gender.
But networks extracted from novels also extract more secondary characters and locutions wrongly considered as characters that are more likely to have an unknown gender.
For this reason, the rate of male and female characters has been computed 2 times.
The first one is a simple rate and the second one has been done using the degree of the nodes as weight.\\

\begin{table}[]
\scalebox{1}{%
\csvautotabular[separator=semicolon]{csv/gender_rate_short.csv}
}
\caption{Mean value and variance on the gendered, male, and female rate of characters, computed on scripts, novels, or all texts. The \textit{gendered rate} represents the rate of characters that have been labeled male or female. The \textit{male} and \textit{female rate} represent the rate of characters that have been labeled male or female. The detailed result is available in appendix \ref{gender_all}.}
\label{gender_short}
\end{table}


\begin{table}[]
\scalebox{1}{%
\csvautotabular[separator=semicolon]{csv/gender_weighted_rate_short.csv}
}
\caption{Mean value and variance on the gendered, male and female weighted rate of characters, computed on scripts, novels, or all texts. The \textit{weighted gendered rate} represents the rate of characters that have been labeled male or female, weighted according to their node degree. The \textit{male} and \textit{female weighted rate} represent the weighted rate of characters that have been labeled male or female. The detailed result are available on appendix \ref{gender_all_weighted}. }
\label{gender_short_weighted}
\end{table}


\begin{table}[]
\scalebox{1}{%
\csvautotabular[separator=semicolon]{csv/gender_degree_short.csv}
}
\caption{Mean degree of the non-gendered, male and female characters, computed on scripts, novels, or all texts. The detailed result are available on appendix \ref{gender_degree_all}. }
\label{gender_degree_short}
\end{table}


Table \ref{gender_short} gives the rate of female and male characters in novels and scripts. A first observation is that scripts have a higher rate of gendered characters than novels. Both novels and scripts tend to have more male characters.
The ratio between the rate of male and female characters is also more important in scripts:$\approx 1.28$ against $\approx 2.87$. For Harry Potter, some movies have a ratio near from the corresponding books (2 and 3), the 6th movie has a lower ratio of male character than the corresponding novels but the first and the fourth movies have a higher ratio. In \textit{Pride and Prejudice}, both the novel and its adaptation have more female characters than male characters but the movie has a ratio nearer from 1.
On appendix \ref{gender_all},19 works out of 73 have a higher rate of female characters: all the novels from the series \textit{A Song of Ice and Fire},  \textit{Pride and Prejudice'}: the novel and the script, The Rain Wild Chronicles 1, The Lunar Chronicles 1 and 3 (the second book have a ratio of 1), The Liveship Traders 2 and 3 and The Wheel of Time ( books 0,2,5,6,7,8,11). Those works tend to be part of the same series. In this list, the only movie script is ``Pride and Prejudice'' a story adapted from a novel that has a ratio of male characters rate over female characters rate far from 1 ($\approx 0.70$), and this ratio increases in the script ($\approx 0.82$).\\

Table \ref{gender_short_weighted} gives weighted rates taking the degree of nodes as weight. Those results give more importance to recurring characters that have a lot of connections. Here the rate of gendered characters is slightly bigger for novels than for scripts. It confirms the intuition that in novels, the extraction of genders produces better results on main characters. In novels, the ratio of male characters over female characters remains constant ($\approx 1,29$) but on scripts the ratio increases ($\approx 3.13$).\\

Table \ref{gender_degree_short} shows that mean degree is bigger for male characters than for female characters. This difference is more important in movie script than in novels. Non-gendered characters have smaller degree especially with novels.


\section{Characterization of networks}
\label{char}

As we saw in the previous section, the extracted social networks have the small-world property and maybe ``ultra-small word``. Their mean path length was shorter than the equivalent family generated of small-world or scale-free networks. Networks extracted from novels have also filled the conditions needed to be considered scale-free: they are constructed using a preferential attachment mechanism and their distribution follows a power-law with a k-value between 2 and 3. Despite these scale-free properties, they have clustering coefficients near to the coefficients of the Watts-Strogatz generated networks. Networks extracted from scripts fill less scale-free conditions: they also follow preferential attachment but the power-law fit doesn't seem more accurate than the exponential fit and the k-value is around $0.96 \notin [2,3]$. They also tend to be higher clustering coefficients. From this, we can not classify them as scale-free but they are near it and some individual networks could be scale-free.\\

In all extracted networks, male characters are more frequent than female characters and they tend to have more importance. This gap is bigger on movie scripts. Scripts adapted from novels also have a lower rate of female characters than the original novel. The non-gendered characters tend to have less importance, especially with novels.


\chapter{Conclusion}
This work consisted in the development of a software extracting social networks from novels, and the analysis of extracted social networks.
The development of the software consisted of 2 major parts: the way characters are extracted has been changed and it has alsoe been extended to work with movie scripts.\\

The new character extraction process takes proper names instead of proper nouns. This is common in state-of-the-art methods but these methods use some tools that were not available in the parsing library used by the software. It made the process of alias-resolution more complex, which has been solved by the development of a multi-pass algorithm using elements of different state-of-the-art methods, especially some rules based on semantic information of names and honorifics. This algorithm is inferring the gender of names to perform the alias resolution. It has been used to label the gender of the extracted characters.
The result has shown that it leads to a decrease of the rate of fake characters by a factor of approximately 2.
It's equivalent to the result of a state-of-the-art method used for comparison.
From this, we can conclude that this change allows for the production of social networks more representative of the networks described by the stories.
The labeling of the gender of different characters is also an enrichment of social networks.
However, character extraction could be improved by using contextual information,
by binding some aliases depending on the context, or by inferring the gender of characters based on the pronoun used to describe them.
The size of the datasets used in order to increase the rate of gendered characters. The filtering of locations among proper names could be improved by using syntactic information.\\

The extension of the software to script further required some adjustment. The biggest difference between novels and scripts is that scripts have annotated speakers for most sentences of dialogs. Scripts also have less contextual information between dialogs.
A new algorithm of character extraction has thus been designed for scripts, using those annotations. It gives better results for scripts than the initial algorithm. \\

The analysis of the social network consisted of the computation of some metrics on the generated networks and the \hyperref[char]{characterization} of the graph related to the characteristics of small-world and scale-free networks. Scripts and novels have been compared and the rate of different gender in the networks has been analyzed. It shows that all networks have the small-world property but only those extracted from novels are totally scale-free. However, networks extracted from scripts are near from some ``soft'' definition of scale-free. Male characters are more frequent in both novels and scripts and have more importance. However, this difference is bigger in movie scripts than in novels. Scripts adapted from novels also have a lower rate of female characters than the original novels.


\listoffigures
\listoftables
\bibliography{biblio}


\begin{appendices}

\chapter{Acronyms of the series}
\label{acronyms}
On the generated graphs available in the appendix, the name of the work is given by the name of the input text file. As some books had a very long name, \cite{original} choose to give them an acronym. For series of multiple novels/ movies, the name of the series is given with the number of the work, instead of the complete title. The following table contains the correspondence between acronyms and novel names that have been shortened. \\


\begin{table}
\center
\scalebox{1}{%
\begin{tabular}{|c|c|}
\hline
Acronym & Title of the series\\
\hline
ASOIAF & A song of Ice and Fire\\
TLC & The Lunar Chronicles\\
TLT & The Liveship Traders\\
TMI & The Mortal Instruments\\
TRWC & The Rain Wild Chronicles\\
TWOT & The Wheel of Time\\
\hline
\end{tabular}}
\caption{Acronyms of novels series.}
\label{acronyms_table}
\end{table}




\chapter{Gender analysis}
\label{gender_table}
\begin{table}[]
\scalebox{0.54}{%
\csvautotabular[separator=semicolon]{csv/gender_rate.csv}
}
\caption{Mean value and variance on the gendered, male, and female rate of characters, computed on scripts, novels, or all texts. The \textit{gendered rate} represents the rate of characters that have been labeled male or female. The \textit{male} and \textit{female rate} represent the rate of characters that have been labeled male or female. }
\label{gender_all}
\end{table}

\begin{table}[]
\scalebox{0.54}{%
\csvautotabular[separator=semicolon]{csv/gender_weighted_rate.csv}
}
\caption{Mean value and variance on the gendered, male, and female rate of characters, computed on scripts, novels, or all texts. The \textit{weighted gendered rate} represents the rate of characters that have been labeled male or female, weighted according to their node degree. The \textit{male} and \textit{female weighted rate} represent the weighted rate of characters that have been labeled male or female. }
\label{gender_all_weighted}
\end{table}


\begin{table}[]
\scalebox{0.54}{%
\csvautotabular[separator=semicolon]{csv/gender_degree.csv}
}
\caption{Mean degree of the non-gendered, male and female characters, computed on scripts, novels, or all texts. }
\label{gender_degree_all}
\end{table}


\chapter{Measures of generated networks}
\label{measures_generated}
For each extracted social network, networks with approximately the same number of edges and nodes have been generated using different generation mechanisms. This section contains the measures computed on the generated networks.


\begin{table}[]
\scalebox{0.50}{
\csvautotabular[separator=semicolon, respect sharp, respect and, respect dollar]{csv/signatures_random.csv}}
\caption{Measures computed on Erdős–Rényi random networks. The title of the associated social network is on the left.}
\end{table}


\begin{table}[]
\scalebox{0.50}{
\csvautotabular[separator=semicolon, respect sharp, respect and, respect dollar]{csv/signatures_scale-free.csv}}
\caption{Measures computed on Barabási-Albert scale-free networks. The title of the associated social network is on the left.}
\end{table}


\begin{table}[]
\scalebox{0.50}{
\csvautotabular[separator=semicolon, respect sharp, respect and, respect dollar]{csv/signatures_small-world.csv}}
\caption{Measures computed on Watts-Strogatz small-world networks. The title of the associated social network is on the left.}
\end{table}


\chapter{Social networks}
This section contains the final incremental networks. In those networks:
\begin{itemize}
\item The size of each node is proportional to its degree.
\item The color of each node is given by its labeled gender: blue for male characters, green for neutral characters, and red for female characters.
\item Edges colors are given by the sentiment between 2 characters.
\item Edge size is given by the weight of the edge which represents the number of conversations 2 characters participate in.
\item Graphs are drawn using Kamada–Kawai algorithm.
\end{itemize}
\label{final_sn}
\input{SN.tex}

\chapter{Preferential attachment}
\label{ref_attachement}
\input{annexeA.tex}




\chapter{Node degree distribution}
\label{a_degree}
\input{appendix_degree.tex}

\chapter{Alias extracted}
This section shows the set of alias designating characters for some novels and books.
The number of appearances of the character and its gender are also given.
The main name is the name used on the social network to designate the character.
\label{alias_extracted}
\input{characters}

\end{appendices}

\end{document}

% Template conçu par Benjamin Vanhemelryck et revu par François Bronchart - Mai 2013